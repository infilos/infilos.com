<!doctype html><html lang=zh class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.93.0">
<meta name=ROBOTS content="INDEX, FOLLOW">
<link rel="shortcut icon" href=/favicons/favicon.ico>
<link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192>
<title>CH18-ArrayList | infilos.com</title><meta property="og:title" content="CH18-ArrayList">
<meta property="og:description" content="做了这么多准备，终于到了 ArrayList 了，ArrayList 是我们使用最为频繁的集合类了，我们先看看文档是如何介绍它的：
 Resizable-array implementation of the List interface. Implements all optional list operations, and permits all elements, including null. In addition to implementing the List interface, this class provides methods to manipulate the size of the array that is used internally to store the list. (This class is roughly equivalent to Vector, except that it is unsynchronized.)
 可见，ArrayList 是 Vector 的翻版，只是去除了线程安全。Vector 因为种种原因不推荐使用了，这里我们就不对其进行分析了。ArrayList 是一个可以动态调整大小的 List 实现，其数据的顺序与插入顺序始终一致，其余特性与 List 中定义的一致。">
<meta property="og:type" content="article">
<meta property="og:url" content="/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch18-arraylist/"><meta property="article:section" content="面试问答">
<meta property="og:site_name" content="infilos.com">
<meta itemprop=name content="CH18-ArrayList">
<meta itemprop=description content="做了这么多准备，终于到了 ArrayList 了，ArrayList 是我们使用最为频繁的集合类了，我们先看看文档是如何介绍它的：
 Resizable-array implementation of the List interface. Implements all optional list operations, and permits all elements, including null. In addition to implementing the List interface, this class provides methods to manipulate the size of the array that is used internally to store the list. (This class is roughly equivalent to Vector, except that it is unsynchronized.)
 可见，ArrayList 是 Vector 的翻版，只是去除了线程安全。Vector 因为种种原因不推荐使用了，这里我们就不对其进行分析了。ArrayList 是一个可以动态调整大小的 List 实现，其数据的顺序与插入顺序始终一致，其余特性与 List 中定义的一致。">
<meta itemprop=wordCount content="730">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content="CH18-ArrayList">
<meta name=twitter:description content="做了这么多准备，终于到了 ArrayList 了，ArrayList 是我们使用最为频繁的集合类了，我们先看看文档是如何介绍它的：
 Resizable-array implementation of the List interface. Implements all optional list operations, and permits all elements, including null. In addition to implementing the List interface, this class provides methods to manipulate the size of the array that is used internally to store the list. (This class is roughly equivalent to Vector, except that it is unsynchronized.)
 可见，ArrayList 是 Vector 的翻版，只是去除了线程安全。Vector 因为种种原因不推荐使用了，这里我们就不对其进行分析了。ArrayList 是一个可以动态调整大小的 List 实现，其数据的顺序与插入顺序始终一致，其余特性与 List 中定义的一致。">
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-123062585-1","auto"),ga("send","pageview"))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<link rel=preload href=/scss/main.min.847464b684a6e89d7276700a5c500c17ab494dd1755b2654a7b27d8b59e3347e.css as=style>
<link href=/scss/main.min.847464b684a6e89d7276700a5c500c17ab494dd1755b2654a7b27d8b59e3347e.css rel=stylesheet integrity>
<script src=/js/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
</head><body class=td-page>
<header>
<nav class="js-navbar-scroll navbar navbar-expand-lg navbar-dark td-navbar">
<a class=navbar-brand href=/>
<span class=navbar-logo><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512"><path style="fill:#ffc107" d="M432.384 143.616c-4.165-4.164-10.917-4.164-15.083.0l-60.352 60.352c-4.164 4.165-4.164 10.917.0 15.083 21.187 20.463 54.951 19.876 75.413-1.311 19.962-20.668 19.962-53.435.0-74.102L432.384 143.616z"/><path style="fill:#607d8b" d="M42.667 277.334c-5.891.003-10.669-4.771-10.672-10.662-.002-4.338 2.623-8.245 6.64-9.882l234.667-96c5.455-2.233 11.687.38 13.92 5.835s-.38 11.687-5.835 13.92l-234.667 96C45.433 277.069 44.056 277.337 42.667 277.334z"/><path style="fill:#546e7a" d="M391.552 56.448l-32-32C343.938 8.745 322.689-.059 300.544.0h-3.755c-46.082.024-83.432 37.374-83.456 83.456v3.755c-.053 22.138 8.75 43.377 24.448 58.987l32 32c4.165 4.164 10.917 4.164 15.083.0L391.531 71.531C395.701 67.372 395.71 60.62 391.552 56.448z"/><path style="fill:#607d8b" d="M160 469.334c-3.279.006-6.379-1.497-8.405-4.075L34.261 315.926c-3.635-4.636-2.823-11.341 1.813-14.976s11.341-2.823 14.976 1.813l117.333 149.333c3.629 4.641 2.809 11.344-1.832 14.973C164.681 468.533 162.375 469.329 160 469.334z"/><path style="fill:#455a64" d="M487.467 86.848l-3.669-3.648c-37.687-36.557-97.71-36.197-134.955.811l-51.413 51.413c-36.996 37.25-37.357 97.263-.811 134.955l3.584 3.669c1.7 2.457 4.671 3.706 7.616 3.2 2.831.005 5.548-1.115 7.552-3.115l172.181-172.181c4.189-4.143 4.226-10.896.083-15.085-.028-.028-.055-.056-.083-.083L487.467 86.848z"/><g><path style="fill:#ffc107" d="M501.333 192H480c-5.891.0-10.667-4.776-10.667-10.667s4.776-10.667 10.667-10.667h21.333c5.891.0 10.667 4.776 10.667 10.667S507.225 192 501.333 192z"/><path style="fill:#ffc107" d="M394.667 298.667c-5.891.0-10.667-4.776-10.667-10.667v-21.333c0-5.891 4.776-10.667 10.667-10.667 5.891.0 10.667 4.776 10.667 10.667V288C405.333 293.891 400.558 298.667 394.667 298.667z"/><path style="fill:#ffc107" d="M480 277.334c-2.831.005-5.548-1.115-7.552-3.115l-21.333-21.333c-4.093-4.237-3.975-10.99.262-15.083 4.134-3.993 10.687-3.993 14.821.0l21.333 21.333c4.159 4.172 4.148 10.926-.024 15.085C485.514 276.209 482.815 277.327 480 277.334z"/></g><g><path style="fill:#455a64" d="M266.667 448H96c-29.455.0-53.333 23.878-53.333 53.333.0 5.891 4.776 10.667 10.667 10.667h256c5.891.0 10.667-4.776 10.667-10.667C320 471.878 296.122 448 266.667 448z"/><circle style="fill:#455a64" cx="32" cy="288" r="32"/></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></span>
<span class=font-weight-bold>infilos.com</span>
</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav mr-auto">
<li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e5%9f%ba%e7%a1%80%e7%9f%a5%e8%af%86>
<span>基础</span>
</a>
</li><li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80>
<span>语言</span>
</a>
</li><li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e6%a1%86%e6%9e%b6%e4%b8%8e%e5%ba%93>
<span>框架库</span>
</a>
</li><li class="nav-item dropdown" style=max-width:90px;min-width:10px>
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
分布式
<span>+</span>
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdown>
<a class=dropdown-item href=/%e5%88%86%e5%b8%83%e5%bc%8f/base>基本构成</a>
</div></li><li class="nav-item dropdown" style=max-width:90px;min-width:10px>
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
大数据
<span>+</span>
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdown>
<a class=dropdown-item href=/%e5%ad%98%e5%82%a8%e7%b3%bb%e7%bb%9f>存储系统</a>
<a class=dropdown-item href=/%e6%9f%a5%e8%af%a2%e7%b3%bb%e7%bb%9f>查询系统</a>
<a class=dropdown-item href=/%e6%b6%88%e6%81%af%e7%b3%bb%e7%bb%9f>消息系统</a>
<a class=dropdown-item href=/%e5%a4%84%e7%90%86%e7%b3%bb%e7%bb%9f>处理系统</a>
<a class=dropdown-item href=/%e6%95%b0%e6%8d%ae%e6%b2%bb%e7%90%86>数据治理</a>
</div></li><li class="nav-item dropdown" style=max-width:90px;min-width:10px>
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
中后台
<span>+</span>
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdown>
<a class=dropdown-item href=/%e5%9f%ba%e7%a1%80%e8%ae%be%e6%96%bd>基础设施</a>
<a class=dropdown-item href=/%e7%94%a8%e6%88%b7%e7%b3%bb%e7%bb%9f>用户系统</a>
<a class=dropdown-item href=/%e4%ba%a4%e4%ba%92%e7%95%8c%e9%9d%a2>交互界面</a>
<a class=dropdown-item href=/%e4%b8%9a%e5%8a%a1%e7%b3%bb%e7%bb%9f>业务系统</a>
</div></li><li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e6%a8%a1%e5%bc%8f%e6%9e%b6%e6%9e%84>
<span>模式架构</span>
</a>
</li><li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e9%9d%a2%e8%af%95%e9%97%ae%e7%ad%94>
<span>面试</span>
</a>
</li><li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e7%ae%a1%e7%90%86%e8%b7%af%e5%be%84>
<span>管理</span>
</a>
</li><li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e5%bc%80%e6%ba%90%e9%a1%b9%e7%9b%ae>
<span>开源</span>
</a>
</li></ul><div class="form-inline my-2 my-lg-0">
<div class="nav-item nav-search-item my-2 my-md-0">
<input type=search class="form-control td-search-input" placeholder="&#xf002; 站内搜索…" aria-label=站内搜索… autocomplete=off>
</div></div></div></nav></header><div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
<div id=td-sidebar-menu class=td-sidebar__inner>
<div id=content-mobile>
<form class="td-sidebar__search d-flex align-items-center">
<input type=search class="form-control td-search-input" placeholder="&#xf002; 站内搜索…" aria-label=站内搜索… autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation">
</button>
</form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav" id=td-section-nav>
<ul class="td-sidebar-nav__section pr-md-3 ul-0">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-e99da2e8af95e997aee7ad94-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-e99da2e8af95e997aee7ad94><span>面试问答</span></a>
<ul class=ul-1>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-e99da2e8af95e997aee7ad94ds-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-e99da2e8af95e997aee7ad94ds><span>数据结构</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch01-e695b0e7bb84-e993bee8a1a8-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch01-%E6%95%B0%E7%BB%84-%E9%93%BE%E8%A1%A8/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch01-e695b0e7bb84-e993bee8a1a8><span>CH01-数组/链表</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch02-e59388e5b88ce8a1a8-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch02-%E5%93%88%E5%B8%8C%E8%A1%A8/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch02-e59388e5b88ce8a1a8><span>CH02-哈希表</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch03-e6a091-e4ba8ce58f89e6a091-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch03-%E6%A0%91-%E4%BA%8C%E5%8F%89%E6%A0%91/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch03-e6a091-e4ba8ce58f89e6a091><span>CH03-树/二叉树</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch04-e68e92e5ba8fe4ba8ce58f89e6a091-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch04-%E6%8E%92%E5%BA%8F%E4%BA%8C%E5%8F%89%E6%A0%91/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch04-e68e92e5ba8fe4ba8ce58f89e6a091><span>CH04-排序二叉树</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch05-e5b9b3e8a1a1e4ba8ce58f89e6a091-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch05-%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%A0%91/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch05-e5b9b3e8a1a1e4ba8ce58f89e6a091><span>CH05-平衡二叉树</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch06-e7baa2e9bb91e6a091-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch06-%E7%BA%A2%E9%BB%91%E6%A0%91/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch06-e7baa2e9bb91e6a091><span>CH06-红黑树</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch07-e59388e5a4abe69bbce6a091-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch07-%E5%93%88%E5%A4%AB%E6%9B%BC%E6%A0%91/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch07-e59388e5a4abe69bbce6a091><span>CH07-哈夫曼树</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch08-e5898de7bc80e6a091-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch08-%E5%89%8D%E7%BC%80%E6%A0%91/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch08-e5898de7bc80e6a091><span>CH08-前缀树</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch09-e59bbee6a682e5bfb5-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch09-%E5%9B%BE%E6%A6%82%E5%BF%B5/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch09-e59bbee6a682e5bfb5><span>CH09-图概念</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch10-e9818de58e86-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch10-%E9%81%8D%E5%8E%86/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch10-e9818de58e86><span>CH10-图遍历</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch11-e69c80e5b08fe7949fe68890e6a091-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch11-%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch11-e69c80e5b08fe7949fe68890e6a091><span>CH11-最小生成树</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch12-e69c80e79fade8b7afe5be84-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch12-%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch12-e69c80e79fade8b7afe5be84><span>CH12-图最短路径</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch13-e68b93e68991e68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch13-%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch13-e68b93e68991e68e92e5ba8f><span>CH13-图拓扑排序</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch14-aoe-e585b3e994aee8b7afe5be84-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch14-aoe-%E5%85%B3%E9%94%AE%E8%B7%AF%E5%BE%84/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch14-aoe-e585b3e994aee8b7afe5be84><span>CH14-图-AOE-关键路径</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch15-iterable-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch15-iterable/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch15-iterable><span>CH15-Iterable</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch16-collection-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch16-collection/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch16-collection><span>CH16-Collection</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch17-list-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch17-list/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch17-list><span>CH17-List</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-e99da2e8af95e997aee7ad94dsch18-arraylist-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch18-arraylist/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch18-arraylist><span class=td-sidebar-nav-active-item>CH18-ArrayList</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch19-queue-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch19-queue/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch19-queue><span>CH19-Queue</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch20-deque-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch20-deque/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch20-deque><span>CH20-Deque</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch21-arrayqueue-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch21-arrayqueue/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch21-arrayqueue><span>CH21-ArrayQueue</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch22-priorityqueue-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch22-priorityqueue/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch22-priorityqueue><span>CH22-PriorityQueue</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch23-linkedlist-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch23-linkedlist/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch23-linkedlist><span>CH23-LinkedList</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch24-vector-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch24-vector/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch24-vector><span>CH24-Vector</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch25-stack-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch25-stack/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch25-stack><span>CH25-Stack</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch26-map-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch26-map/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch26-map><span>CH26-Map</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch27-sortedmap-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch27-sortedmap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch27-sortedmap><span>CH27-SortedMap</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch28-navigablemap-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch28-navigablemap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch28-navigablemap><span>CH28-NavigableMap</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch29-treemap-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch29-treemap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch29-treemap><span>CH29-TreeMap</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch30-hashmap-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch30-hashmap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch30-hashmap><span>CH30-HashMap</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch31-linkedhashmap-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch31-linkedhashmap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch31-linkedhashmap><span>CH31-LinkedHashMap</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch32-enummap-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch32-enummap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch32-enummap><span>CH32-EnumMap</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch33-hashtable-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch33-hashtable/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch33-hashtable><span>CH33-HashTable</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch34-set-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch34-set/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch34-set><span>CH34-Set</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch35-enumset-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch35-enumset/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch35-enumset><span>CH35-EnumSet</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch36-hashset-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch36-hashset/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch36-hashset><span>CH36-HashSet</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch37-linkedhashset-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch37-linkedhashset/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch37-linkedhashset><span>CH37-LinkedHashSet</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch38-treeset-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch38-treeset/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch38-treeset><span>CH38-TreeSet</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94dsch39-failfast-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch39-failfast/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94dsch39-failfast><span>CH39-FailFast</span></a>
</li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-e99da2e8af95e997aee7ad94algo-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-e99da2e8af95e997aee7ad94algo><span>排序算法</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-e99da2e8af95e997aee7ad94algoch01-e58692e6b3a1e68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ch01-%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94algoch01-e58692e6b3a1e68e92e5ba8f><span>CH01-冒泡排序</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-e99da2e8af95e997aee7ad94algoch02-e98089e68ba9e68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ch02-%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94algoch02-e98089e68ba9e68e92e5ba8f><span>CH02-选择排序</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-e99da2e8af95e997aee7ad94algoch03-e68f92e585a5e68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ch03-%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94algoch03-e68f92e585a5e68e92e5ba8f><span>CH03-插入排序</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-e99da2e8af95e997aee7ad94algoch04-e5b88ce5b094e68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ch04-%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94algoch04-e5b88ce5b094e68e92e5ba8f><span>CH04-希尔排序</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-e99da2e8af95e997aee7ad94algoch05-e5bd92e5b9b6e68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ch05-%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94algoch05-e5bd92e5b9b6e68e92e5ba8f><span>CH05-归并排序</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-e99da2e8af95e997aee7ad94algoch06-e5bfabe9809fe68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ch06-%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94algoch06-e5bfabe9809fe68e92e5ba8f><span>CH06-快速排序</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-e99da2e8af95e997aee7ad94algoch07-e5a086e68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ch07-%E5%A0%86%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94algoch07-e5a086e68e92e5ba8f><span>CH07-堆排序</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-e99da2e8af95e997aee7ad94algoch08-e8aea1e695b0e68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ch08-%E8%AE%A1%E6%95%B0%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94algoch08-e8aea1e695b0e68e92e5ba8f><span>CH08-计数排序</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-e99da2e8af95e997aee7ad94algoch09-e6a1b6e68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ch09-%E6%A1%B6%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94algoch09-e6a1b6e68e92e5ba8f><span>CH09-桶排序</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-e99da2e8af95e997aee7ad94algoch10-e59fbae695b0e68e92e5ba8f-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/algo/ch10-%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-e99da2e8af95e997aee7ad94algoch10-e59fbae695b0e68e92e5ba8f><span>CH10-基数排序</span></a>
</li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94e58991e68c87-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/%E5%89%91%E6%8C%87/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-e99da2e8af95e997aee7ad94e58991e68c87><span>剑指 Offer</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94e99da2e8af95e5ae9de585b8-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/%E9%9D%A2%E8%AF%95%E5%AE%9D%E5%85%B8/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-e99da2e8af95e997aee7ad94e99da2e8af95e5ae9de585b8><span>面试宝典</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94e99da2e8af95e98791e585b8-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/%E9%9D%A2%E8%AF%95%E9%87%91%E5%85%B8/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-e99da2e8af95e997aee7ad94e99da2e8af95e98791e585b8><span>面试金典</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94e99da2e8af95e68c87e58d97-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/%E9%9D%A2%E8%AF%95%E6%8C%87%E5%8D%97/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-e99da2e8af95e997aee7ad94e99da2e8af95e68c87e58d97><span>面试指南</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-e99da2e8af95e997aee7ad94leet-code-li>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/leet-code/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-e99da2e8af95e997aee7ad94leet-code><span>Leet Code</span></a>
</li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href=https://github.com/infilos/infilos.com/edit/master/content/zh/%e9%9d%a2%e8%af%95%e9%97%ae%e7%ad%94/ds/CH18-ArrayList.md target=_blank><i class="fa fa-edit fa-fw"></i> 编辑此页</a>
<a href="https://github.com/infilos/infilos.com/new/master/content/zh/%e9%9d%a2%e8%af%95%e9%97%ae%e7%ad%94/ds/CH18-ArrayList.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> 添加子页面</a>
<a href="https://github.com/infilos/infilos.com/issues/new?title=CH18-ArrayList" target=_blank><i class="fab fa-github fa-fw"></i> 提交文档问题</a>
<a id=print href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/_print/><i class="fa fa-print fa-fw"></i> 整节打印</a>
</div><div class=td-toc><nav id=TableOfContents>
<ul>
<li><a href=#继承结构>继承结构</a></li><li><a href=#构造方法与初始化>构造方法与初始化</a></li><li><a href=#重要方法>重要方法</a></li><li><a href=#其他实现方法>其他实现方法</a></li><li><a href=#总结>总结</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<nav aria-label=breadcrumb class="d-none d-md-block d-print-none">
<ol class="breadcrumb spb-1">
<li class=breadcrumb-item>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/>面试问答</a>
</li><li class=breadcrumb-item>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/>数据结构</a>
</li><li class="breadcrumb-item active" aria-current=page>
<a href=/%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94/ds/ch18-arraylist/>CH18-ArrayList</a>
</li></ol></nav><div class=td-content>
<h1>CH18-ArrayList</h1><header class=article-meta>
</header><p>做了这么多准备，终于到了 ArrayList 了，ArrayList 是我们使用最为频繁的集合类了，我们先看看文档是如何介绍它的：</p><blockquote>
<p><strong>Resizable-array</strong> implementation of the List interface. Implements all optional list operations, and permits all elements, <strong>including null</strong>. In addition to implementing the List interface, this class provides methods to manipulate the size of the array that is used internally to store the list. (This class is roughly equivalent to <strong>Vector</strong>, except that it is <strong>unsynchronized</strong>.)</p></blockquote><p>可见，ArrayList 是 Vector 的翻版，只是去除了线程安全。Vector 因为种种原因不推荐使用了，这里我们就不对其进行分析了。ArrayList 是一个可以动态调整大小的 List 实现，其数据的顺序与插入顺序始终一致，其余特性与 List 中定义的一致。</p><h2 id=继承结构>继承结构</h2><div align=center> <img src=https://infi-img.oss-cn-hangzhou.aliyuncs.com/img/20190221002604.png style=display:block;width:70% alt=NAME align=center> </div><p>可以看到，ArrayList 是 AbstractList 的子类，同时实现了 List 接口。除此之外，它还实现了三个标识型接口，这几个接口都没有任何方法，仅作为标识表示实现类具备某项功能。RandomAccess 表示实现类支持快速随机访问，Cloneable 表示实现类支持克隆，具体表现为重写了 clone 方法，java.io.Serializable 则表示支持序列化，如果需要对此过程自定义，可以重写 writeObject 与 readObject 方法。</p><p>一般面试问到与 ArrayList 相关的问题时，可能会问 ArrayList 的初始大小是多少？很多人在初始化 ArrayList 时，可能都是直接调用无参构造函数，从未关注过此问题。例如，这样获取一个对象：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>strings</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;&gt;();</span>
</span></span></code></pre></div><p>我们都知道，ArrayList 是基于数组的，而数组是定长的。那 ArrayList 为何不需要指定长度，就能使我们既可以插入一条数据，也可以插入一万条数据？回想刚刚文档的第一句话：</p><blockquote>
<p>Resizable-array implementation of the List interface.</p></blockquote><p>ArrayList 可以动态调整大小，所以我们才可以无感知的插入多条数据，这也说明其必然有一个默认的大小。而要想扩充数组的大小，只能通过复制。这样一来，默认大小以及如何动态调整大小会对使用性能产生非常大的影响。我们举个例子来说明此情形：</p><p>比如默认大小为 5，我们向 ArrayList 中插入 5 条数据，并不会涉及到扩容。如果想插入 100 条数据，就需要将 ArrayList 大小调整到 100 再进行插入，这就涉及一次数组的复制。如果此时，还想再插入 50 条数据呢？那就得把大小再调整到 150，把原有的 100 条数据复制过来，再插入新的 50 条数据。自此之后，我们每向其中插入一条数据，都要涉及一次数据拷贝，且数据量越大，需要拷贝的数据越多，性能也会迅速下降。</p><p>其实，ArrayList 仅仅是对数组操作的封装，里面采取了一定的措施来避免以上的问题，如果我们不利用这些措施，就和直接使用数组没有太大的区别。那我们就看看 ArrayList 用了哪些措施，并且如何使用它们吧。我们先从初始化说起。</p><h2 id=构造方法与初始化>构造方法与初始化</h2><p>ArrayList 一共有三个构造方法，用到了两个成员变量。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//这是一个用来标记存储容量的数组，也是存放实际数据的数组。
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//当 ArrayList 扩容时，其 capacity 就是这个数组应有的长度。
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//默认时为空，添加进第一个元素后，就会直接扩展到 DEFAULT_CAPACITY，也就是 10
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//这里和size区别在于，ArrayList扩容并不是需要多少就扩展多少的
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>transient</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//这里就是实际存储的数据个数了
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span></code></pre></div><p>除了以上两个成员变量，我们还需要掌握一个变量，它是:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>transient</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>modCount</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span></code></pre></div><p>这个变量主要作用是防止在进行一些操作时，改变了ArrayList的大小，那将使得结果不可预测。</p><p>下面我们看看构造函数：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//默认构造方法。文档说明其默认大小为10，但正如elementData定义所言，
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//只有插入一条数据后才会扩展为10，而实际上默认是空的
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>elementData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//带初始大小的构造方法，一旦指定了大小，elementData就不再是原来的机制了。
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>initialCapacity</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>initialCapacity</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>elementData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>initialCapacity</span><span style=color:#ce5c00;font-weight:700>];</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>initialCapacity</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>elementData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>EMPTY_ELEMENTDATA</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>IllegalArgumentException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;Illegal Capacity: &#34;</span><span style=color:#ce5c00;font-weight:700>+</span>                                         <span style=color:#000>initialCapacity</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//从一个其他的Collection中构造一个具有初始化数据的ArrayList。
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//这里可以看到size是表示存储数据的数量
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//这也展示了Collection这种抽象的魅力，可以在不同的结构间转换
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Collection</span><span style=color:#ce5c00;font-weight:700>&lt;?</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>E</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>c</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//转换最主要的是toArray()，这在Collection中就定义了
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>elementData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>c</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>toArray</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>((</span><span style=color:#000>size</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[].</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>            <span style=color:#000>elementData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Arrays</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>copyOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[].</span><span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// replace with empty array.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>this</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>elementData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>EMPTY_ELEMENTDATA</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=重要方法>重要方法</h2><p>ArrayList 已经是一个具体的实现类了，所以在 List 接口中定义的所有方法在此都做了实现。其中有些在 AbstractList 中实现过的方法，在这里再次被重写，我们稍后就可以看到它们的区别。</p><p>先看一些简单的方法：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//还记得在AbstractList中的实现吗？那是基于Iterator完成的。
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//在这里完全没必要先转成Iterator再进行操作
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>indexOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>o</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>o</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]==</span><span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>o</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>equals</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]))</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>1</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//和indexOf是相同的道理
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span> <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>lastIndexOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>o</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//一样的道理，已经有了所有元素，不需要再利用Iterator来获取元素了
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//注意这里返回时把elementData截断为size大小
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Object</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>toArray</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>Arrays</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>copyOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//带类型的转换，看到这里a[size] = null;这个用处真不大，除非你确定所有元素都不为空，
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//才可以通过null来判断获取了多少有用数据。
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>toArray</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>[]</span> <span style=color:#000>a</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>a</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// 给定的数据长度不够，复制出一个新的并返回
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>T</span><span style=color:#ce5c00;font-weight:700>[])</span> <span style=color:#000>Arrays</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>copyOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>a</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getClass</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>arraycopy</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>a</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>a</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>a</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>a</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>数据操作最重要的就是增删改查，改查都不涉及长度的变化，而增删就涉及到动态调整大小的问题，我们先看看改和查是如何实现的：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>rangeCheck</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>index</span> <span style=color:#ce5c00;font-weight:700>&gt;=</span> <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>IndexOutOfBoundsException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>outOfBoundsMsg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//只要获取的数据位置在0-size之间即可
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>E</span> <span style=color:#000>get</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>rangeCheck</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//改变下对应位置的值
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>E</span> <span style=color:#000>set</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>E</span> <span style=color:#000>element</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>rangeCheck</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>E</span> <span style=color:#000>oldValue</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>element</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>oldValue</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>增和删是ArrayList最重要的部分，这部分代码需要我们细细研究，我们看看它是如何处理我们例子中的问题的：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//在最后添加一个元素
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>E</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//先确保elementData数组的长度足够
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>ensureCapacityInternal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>size</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>1</span><span style=color:#ce5c00;font-weight:700>);</span>  <span style=color:#8f5902;font-style:italic>// Increments modCount!!
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>++]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>e</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>add</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>E</span> <span style=color:#000>element</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>rangeCheckForAdd</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//先确保elementData数组的长度足够
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>ensureCapacityInternal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>size</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>1</span><span style=color:#ce5c00;font-weight:700>);</span>  <span style=color:#8f5902;font-style:italic>// Increments modCount!!
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>//将数据向后移动一位，空出位置之后再插入
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>System</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>arraycopy</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>index</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>1</span><span style=color:#ce5c00;font-weight:700>,</span>
</span></span><span style=display:flex><span>                         <span style=color:#000>size</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>element</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>++;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>以上两种添加数据的方式都调用到了 ensureCapacityInternal 这个方法，我们看看它是如何完成工作的：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//在定义elementData时就提过，插入第一个数据就直接将其扩充至10
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>ensureCapacityInternal</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>minCapacity</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>minCapacity</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Math</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>max</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DEFAULT_CAPACITY</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>minCapacity</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//这里把工作又交了出去
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>ensureExplicitCapacity</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>minCapacity</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//如果elementData的长度不能满足需求，就需要扩充了
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>ensureExplicitCapacity</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>minCapacity</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>modCount</span><span style=color:#ce5c00;font-weight:700>++;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// overflow-conscious code
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>minCapacity</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>grow</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>minCapacity</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//扩充
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>grow</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>minCapacity</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// overflow-conscious code
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>oldCapacity</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>length</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//可以看到这里是1.5倍扩充的
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>newCapacity</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>oldCapacity</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>oldCapacity</span> <span style=color:#ce5c00;font-weight:700>&gt;&gt;</span> <span style=color:#000>1</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//扩充完之后，还是没满足，这时候就直接扩充到minCapacity
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>newCapacity</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>minCapacity</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>newCapacity</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>minCapacity</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//防止溢出
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>newCapacity</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>MAX_ARRAY_SIZE</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>newCapacity</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>hugeCapacity</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>minCapacity</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// minCapacity is usually close to size, so this is a win:
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>elementData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Arrays</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>copyOf</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>newCapacity</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>至此，我们彻底明白了 ArrayList 的扩容机制了。首先创建一个空数组 elementData，第一次插入数据时直接扩充至 10，然后如果 elementData 的长度不足，就扩充 <strong>1.5</strong> 倍，如果扩充完还不够，就使用需要的长度作为 elementData 的长度。</p><p>这样的方式显然比我们例子中好一些，但是在遇到大量数据时还是会频繁的拷贝数据。那么如何缓解这种问题呢，ArrayList为我们提供了两种可行的方案：</p><ul>
<li>使用 <code>ArrayList(int initialCapacity)</code> 这个有参构造，在创建时就声明一个较大的大小，这样解决了频繁拷贝问题，但是需要我们提前预知数据的数量级，也会一直占有较大的内存。</li><li>除了添加数据时可以自动扩容外，我们还可以在插入前先进行一次扩容。只要提前预知数据的数量级，就可以在需要时直接一次扩充到位，与 <code>ArrayList(int initialCapacity)</code> 相比的好处在于不必一直占有较大内存，同时数据拷贝的次数也大大减少了。这个方法就是 <code>ensureCapacity(int minCapacity)</code>，其内部就是调用了 <code>ensureCapacityInternal(int minCapacity)</code>。</li></ul><p>其他还有一些比较重要的函数，其实现的原理也大同小异，这里我们不一一分析了，但还是把它们列举出来，以便使用。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//将elementData的大小设置为和size一样大，释放所有无用内存
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>trimToSize</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//删除指定位置的元素
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>E</span> <span style=color:#000>remove</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//根据元素本身删除
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>remove</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Object</span> <span style=color:#000>o</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//在末尾添加一些元素
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>addAll</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Collection</span><span style=color:#ce5c00;font-weight:700>&lt;?</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>E</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>c</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//从指定位置起，添加一些元素
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>addAll</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Collection</span><span style=color:#ce5c00;font-weight:700>&lt;?</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>E</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>c</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//删除指定范围内的元素
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>protected</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>removeRange</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>fromIndex</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>toIndex</span><span style=color:#ce5c00;font-weight:700>){</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//删除所有包含在c中的元素
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>removeAll</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Collection</span><span style=color:#ce5c00;font-weight:700>&lt;?&gt;</span> <span style=color:#000>c</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//仅保留所有包含在c中的元素
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>retainAll</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>Collection</span><span style=color:#ce5c00;font-weight:700>&lt;?&gt;</span> <span style=color:#000>c</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>ArrayList 还对父级实现的 ListIterator 以及 SubList 进行了优化，主要是使用位置访问元素，我们就不再研究了。</p><h2 id=其他实现方法>其他实现方法</h2><p>ArrayList 不仅实现了 List 中定义的所有功能，还实现了 equals、hashCode、clone、writeObject 与 readObject 等方法。这些方法都需要与存储的数据配合，否则结果将是错误的或者克隆得到的数据只是浅拷贝，或者数据本身不支持序列化等，这些我们定义数据时注意到即可。我们主要看下其在序列化时自定义了哪些东西。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//这里就能解开我们的迷惑了，elementData被transient修饰，也就是不会参与序列化
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>//这里我们看到数据是一个个写入的，并且将size也写入了进去
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>writeObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>java</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>io</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ObjectOutputStream</span> <span style=color:#000>s</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>java</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>io</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>IOException</span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Write out element count, and any hidden stuff
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>expectedModCount</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>modCount</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>s</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>defaultWriteObject</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Write out size as capacity for behavioural compatibility with clone()
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>s</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>writeInt</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Write out all elements in the proper order.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>size</span><span style=color:#ce5c00;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>s</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>writeObject</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>elementData</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//modCount的作用在此体现，如果序列化时进行了修改操作，就会抛出异常
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>modCount</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#000>expectedModCount</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ConcurrentModificationException</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>readObject是一个相反的过程，就是把数据正确的恢复回来，并将elementData设置好即可，感兴趣可以自行阅读源码。</p><h2 id=总结>总结</h2><p>总体而言，ArrayList 还是和数组一样，更适合于数据随机访问，而不太适合于大量的插入与删除，如果一定要进行插入操作，要使用以下三种方式：</p><ul>
<li>使用 <code>ArrayList(int initialCapacity)</code> 这个有参构造，在创建时就声明一个较大的大小。</li><li>使用 <code>ensureCapacity(int minCapacity)</code>，在插入前先扩容。</li><li>使用 LinkedList，我们很快就会介绍这个适合于增删的集合类。</li></ul><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none>
<h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button>
<p class="feedback--response feedback--response-yes">
Glad to hear it! Please <a href=https://github.com/infilos/infilos.com/issues/new>tell us how we can improve</a>.
</p><p class="feedback--response feedback--response-no">
Sorry to hear that. Please <a href=https://github.com/infilos/infilos.com/issues/new>tell us how we can improve</a>.
</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=t=>{if(typeof ga!="function")return;const e={command:"send",hitType:"event",category:"Helpful",action:"click",label:window.location.pathname,value:t};ga(e.command,e.hitType,e.category,e.action,e.label,e.value)};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script>
<br>
</div></main></div></div><footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Weibo aria-label=Weibo>
<a class=text-white target=_blank rel="noopener noreferrer" href=https://weibo.com/u/3848950217>
<i class="fab fa-weibo"></i>
</a>
</li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter>
<a class=text-white target=_blank rel="noopener noreferrer" href=https://twitter.com/zhange_zzg>
<i class="fab fa-twitter"></i>
</a>
</li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow">
<a class=text-white target=_blank rel="noopener noreferrer" href=https://stackoverflow.com>
<i class="fab fa-stack-overflow"></i>
</a>
</li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/infilos/infilos.com>
<i class="fab fa-github"></i>
</a>
</li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2022 infilos.com All Rights Reserved</small>
</div></div></div></footer></div><script src=/js/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script>
<script src=/js/main.min.3f3f4f1e22307ccbb13271a98be2e4dbb8386b7e67c3d606db44d3d0649f485e.js integrity="sha256-Pz9PHiIwfMuxMnGpi+Lk27g4a35nw9YG20TT0GSfSF4=" crossorigin=anonymous></script>
</body></html>