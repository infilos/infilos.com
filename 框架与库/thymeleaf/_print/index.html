<!doctype html><html lang=zh class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.89.4">
<meta name=ROBOTS content="INDEX, FOLLOW">
<link rel=canonical type=text/html href=/%E6%A1%86%E6%9E%B6%E4%B8%8E%E5%BA%93/thymeleaf/>
<link rel="shortcut icon" href=/favicons/favicon.ico>
<link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192>
<title>Thymeleaf | infilos.com</title><meta property="og:title" content="Thymeleaf">
<meta property="og:description" content="Infilos Wiki Website">
<meta property="og:type" content="website">
<meta property="og:url" content="/%E6%A1%86%E6%9E%B6%E4%B8%8E%E5%BA%93/thymeleaf/"><meta property="og:site_name" content="infilos.com">
<meta itemprop=name content="Thymeleaf">
<meta itemprop=description content="Infilos Wiki Website"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Thymeleaf">
<meta name=twitter:description content="Infilos Wiki Website">
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-123062585-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<link rel=preload href=/scss/main.min.847464b684a6e89d7276700a5c500c17ab494dd1755b2654a7b27d8b59e3347e.css as=style>
<link href=/scss/main.min.847464b684a6e89d7276700a5c500c17ab494dd1755b2654a7b27d8b59e3347e.css rel=stylesheet integrity>
<script src=/js/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
</head>
<body class=td-section>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/>
<span class=navbar-logo><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512"><path style="fill:#ffc107" d="M432.384 143.616c-4.165-4.164-10.917-4.164-15.083.0l-60.352 60.352c-4.164 4.165-4.164 10.917.0 15.083 21.187 20.463 54.951 19.876 75.413-1.311 19.962-20.668 19.962-53.435.0-74.102L432.384 143.616z"/><path style="fill:#607d8b" d="M42.667 277.334c-5.891.003-10.669-4.771-10.672-10.662-.002-4.338 2.623-8.245 6.64-9.882l234.667-96c5.455-2.233 11.687.38 13.92 5.835s-.38 11.687-5.835 13.92l-234.667 96C45.433 277.069 44.056 277.337 42.667 277.334z"/><path style="fill:#546e7a" d="M391.552 56.448l-32-32C343.938 8.745 322.689-.059 300.544.0h-3.755c-46.082.024-83.432 37.374-83.456 83.456v3.755c-.053 22.138 8.75 43.377 24.448 58.987l32 32c4.165 4.164 10.917 4.164 15.083.0L391.531 71.531C395.701 67.372 395.71 60.62 391.552 56.448z"/><path style="fill:#607d8b" d="M160 469.334c-3.279.006-6.379-1.497-8.405-4.075L34.261 315.926c-3.635-4.636-2.823-11.341 1.813-14.976s11.341-2.823 14.976 1.813l117.333 149.333c3.629 4.641 2.809 11.344-1.832 14.973C164.681 468.533 162.375 469.329 160 469.334z"/><path style="fill:#455a64" d="M487.467 86.848l-3.669-3.648c-37.687-36.557-97.71-36.197-134.955.811l-51.413 51.413c-36.996 37.25-37.357 97.263-.811 134.955l3.584 3.669c1.7 2.457 4.671 3.706 7.616 3.2 2.831.005 5.548-1.115 7.552-3.115l172.181-172.181c4.189-4.143 4.226-10.896.083-15.085-.028-.028-.055-.056-.083-.083L487.467 86.848z"/><g><path style="fill:#ffc107" d="M501.333 192H480c-5.891.0-10.667-4.776-10.667-10.667s4.776-10.667 10.667-10.667h21.333c5.891.0 10.667 4.776 10.667 10.667S507.225 192 501.333 192z"/><path style="fill:#ffc107" d="M394.667 298.667c-5.891.0-10.667-4.776-10.667-10.667v-21.333c0-5.891 4.776-10.667 10.667-10.667 5.891.0 10.667 4.776 10.667 10.667V288C405.333 293.891 400.558 298.667 394.667 298.667z"/><path style="fill:#ffc107" d="M480 277.334c-2.831.005-5.548-1.115-7.552-3.115l-21.333-21.333c-4.093-4.237-3.975-10.99.262-15.083 4.134-3.993 10.687-3.993 14.821.0l21.333 21.333c4.159 4.172 4.148 10.926-.024 15.085C485.514 276.209 482.815 277.327 480 277.334z"/></g><g><path style="fill:#455a64" d="M266.667 448H96c-29.455.0-53.333 23.878-53.333 53.333.0 5.891 4.776 10.667 10.667 10.667h256c5.891.0 10.667-4.776 10.667-10.667C320 471.878 296.122 448 266.667 448z"/><circle style="fill:#455a64" cx="32" cy="288" r="32"/></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></span><span class=font-weight-bold>infilos.com</span>
</a>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav mr-auto">
<li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e5%9f%ba%e7%a1%80%e7%9f%a5%e8%af%86>
<span>基础</span>
</a>
</li>
<li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80>
<span>语言</span>
</a>
</li>
<li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e6%a1%86%e6%9e%b6%e4%b8%8e%e5%ba%93>
<span>框架库</span>
</a>
</li>
<li class="nav-item dropdown" style=max-width:90px;min-width:10px>
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
分布式
<span>+</span>
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdown>
<a class=dropdown-item href=/%e5%88%86%e5%b8%83%e5%bc%8f/base>基本构成</a>
</div>
</li>
<li class="nav-item dropdown" style=max-width:90px;min-width:10px>
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
大数据
<span>+</span>
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdown>
<a class=dropdown-item href=/%e5%ad%98%e5%82%a8%e7%b3%bb%e7%bb%9f>存储系统</a>
<a class=dropdown-item href=/%e6%9f%a5%e8%af%a2%e7%b3%bb%e7%bb%9f>查询系统</a>
<a class=dropdown-item href=/%e6%b6%88%e6%81%af%e7%b3%bb%e7%bb%9f>消息系统</a>
<a class=dropdown-item href=/%e5%a4%84%e7%90%86%e7%b3%bb%e7%bb%9f>处理系统</a>
<a class=dropdown-item href=/%e6%95%b0%e6%8d%ae%e6%b2%bb%e7%90%86>数据治理</a>
</div>
</li>
<li class="nav-item dropdown" style=max-width:90px;min-width:10px>
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
中后台
<span>+</span>
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdown>
<a class=dropdown-item href=/%e5%9f%ba%e7%a1%80%e8%ae%be%e6%96%bd>基础设施</a>
<a class=dropdown-item href=/%e7%94%a8%e6%88%b7%e7%b3%bb%e7%bb%9f>用户系统</a>
<a class=dropdown-item href=/%e4%ba%a4%e4%ba%92%e7%95%8c%e9%9d%a2>交互界面</a>
<a class=dropdown-item href=/%e4%b8%9a%e5%8a%a1%e7%b3%bb%e7%bb%9f>业务系统</a>
</div>
</li>
<li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e6%a8%a1%e5%bc%8f%e6%9e%b6%e6%9e%84>
<span>模式架构</span>
</a>
</li>
<li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e9%9d%a2%e8%af%95%e9%97%ae%e7%ad%94>
<span>面试</span>
</a>
</li>
<li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e7%ae%a1%e7%90%86%e8%b7%af%e5%be%84>
<span>管理</span>
</a>
</li>
<li class=nav-item style=max-width:90px;min-width:10px>
<a class=nav-link href=/%e5%bc%80%e6%ba%90%e9%a1%b9%e7%9b%ae>
<span>开源</span>
</a>
</li>
</ul>
<div class="form-inline my-2 my-lg-0">
<div class="nav-item nav-search-item my-2 my-md-0">
<input type=search class="form-control td-search-input" placeholder="&#xf002; 站内搜索…" aria-label=站内搜索… autocomplete=off>
</div>
</div>
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
</div>
<div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
</div>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<div class=td-content>
<div class="pageinfo pageinfo-primary d-print-none">
<p>
这是本节的多页打印视图。
<a href=# onclick="return print(),!1">点击此处打印</a>.
</p><p>
<a href=/%E6%A1%86%E6%9E%B6%E4%B8%8E%E5%BA%93/thymeleaf/>返回本页常规视图</a>.
</p>
</div>
<h1 class=title>Thymeleaf</h1>
<ul>
<li>1: <a href=#pg-bc8f97bd6165ad74ccc5964528133a7a>CH01-介绍</a></li>
<li>2: <a href=#pg-399b5319f1df6cc8ec7add459d3cb3f7>CH02-使用文本</a></li>
<li>3: <a href=#pg-6709d6272471dac1238c1b709826b488>CH03-表达式</a></li>
<li>4: <a href=#pg-b6f300e1180704988751105f265cb623>CH04-设置属性值</a></li>
<li>5: <a href=#pg-18723f42642cdfaa0bb50c09f8c2f183>CH05-迭代器</a></li>
<li>6: <a href=#pg-656df381e4d5a32cee976c78a557d4ee>CH06-条件语句</a></li>
<li>7: <a href=#pg-819a0eba1a94261161b32081fb1869e1>CH07-模板布局</a></li>
<li>8: <a href=#pg-912caea4dafa19f95e7b88f898f02ef8>CH08-局部变量</a></li>
<li>9: <a href=#pg-1fa293f76e8532b99774044f0a643a63>CH09-属性优先级</a></li>
<li>10: <a href=#pg-75f12df78c0ac5f78030b77ad55a7c6d>CH10-注释及注释块</a></li>
<li>11: <a href=#pg-86abf045bab87e9849dc45e08f247d65>CH11-内联</a></li>
</ul>
<div class=content>
<p>Thymeleaf Tutorials.</p>
</div>
</div>
<div class=td-content>
<h1 id=pg-bc8f97bd6165ad74ccc5964528133a7a>1 - CH01-介绍</h1>
<h2 id=什么是-thymeleaf>什么是 Thymeleaf</h2>
<p>Thymeleaf 是面向 Web 和独立环境的现代服务器端 Java 模板引擎，能够处理 HTML、XML、JavaScript、CSS 甚至纯文本。</p>
<p>Thymeleaf 的主要目标是提供一个优雅和高度可维护的创建模板的方式。 为了实现这一点，它建立在自然模板（ Natural Templates）的概念上，将其逻辑注入到模板文件中，不会影响模板被用作设计原型。 这改善了设计的沟通，弥合了设计和开发团队之间的差距。</p>
<p>Thymeleaf 的设计从一开始就遵从 Web 标准，特别是 HTML5，这样就能创建完全符合验证的模板。</p>
<h2 id=处理模版>处理模版</h2>
<p>Thymeleaf 能处理以下 6 种类型的模版，我们称之为<strong>模版模式（Template Mode）</strong>:</p>
<ul>
<li>HTML</li>
<li>XML</li>
<li>TEXT</li>
<li>JAVASCRIPT</li>
<li>CSS</li>
<li>RAW</li>
</ul>
<p>其中包含有两种标记模板模式（HTML和XML），三种文本模板模式（TEXT、JAVASCRIPT和CSS）和一个无操作模板模式（RAW）。</p>
<p>HTML 模板模式将允许任何类型的 HTML输入，包括HTML5、HTML4和XHTML。将不执行验证或对格式进行严格检查，这样就能尽可能的将模板代码/结构进行输出。</p>
<p>XML 模板模式将允许XML输入。在这种情况下，代码预期格式是良好的——没有未关闭的标签，没有引用属性等，如果找到为符合格式要求，解析器将抛出异常。请注意，不会执行验证（针对DTD或XML架构）。</p>
<p>TEXT 模板模式将允许对非标记性质的模板使用特殊语法。此类模板的示例可能是文本电子邮件或模板文档。请注意，HTML或XML模板也可以作为TEXT处理，在这种情况下，它们将不会被解析为标记，并且每个标签DOCTYPE、注释等将被视为纯文本。</p>
<p>JAVASCRIPT 模板模式将允许在Thymeleaf应用程序中处理JavaScript文件。这意味着能够使用JavaScript文件中的模型数据与HTML文件中可以完成的方式相同，但可以使用特定于JavaScript的集成，例如专门的转义或自然脚本（natural scripting）。 JAVASCRIPT模板模式被认为是文本模式，因此使用与TEXT模板模式相同的特殊语法。</p>
<p>CSS 模板模式将允许处理涉及Thymeleaf应用程序的CSS文件。与JAVASCRIPT模式类似，CSS模板模式也是文本模式，并使用TEXT模板模式下的特殊处理语法。</p>
<p>RAW 模板模式根本不会处理模板。它用于将未经修改的资源（文件、URL响应等）插入正在处理的模板中。例如，HTML格式的外部不受控制的资源可以包含在应用程序模板中，安全地知道这些资源可能包含的任何Thymeleaf代码将不会被执行。</p>
<h2 id=标准方言>标准方言</h2>
<p>Thymeleaf是一个非常可扩展的模板引擎，实际上它更像是一个模板引擎框架（template engine framework）），允许您定义和自定义您的模板。</p>
<p>将一些逻辑应用于标记工件（例如标签、某些文本、注释或只有占位符）的一个对象被称为处理器（processor）。方言（dialect）通常包括这些处理器的集合以及一些额外的工件。Thymeleaf 的核心库提供了一种称为标准方言（Standard Dialect）的方言，提供给用户开箱即用的功能。</p>
<p>当然，如果用户希望在利用库的高级功能的同时定义自己的处理逻辑，用户也可以创建自己的方言（甚至扩展标准的方言）。也可以将Thymeleaf配置为同时使用几种方言。</p>
<blockquote>
<p>官方的 thymeleaf-spring3 和 thymeleaf-spring4 集成包都定义了一种称为“SpringStandard Dialect”的方言，与标准方言大致相同，但是对于 Spring 框架中的某些功能则更加友好，例如， 想通过使用Spring Expression Language 或 SpringEL 而不是 OGNL。所以如果你是一个Spring MVC用户，这里的所有东西都能够在你的Spring应用程序中使用。</p>
</blockquote>
<p>标准方言的大多数处理器是属性处理器。这样，即使在处理之前，浏览器也可以正确地显示HTML模板文件，因为它们将简单地忽略其他属性。对比JSP，在浏览器中会直接显示的代码片断：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form:inputText</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;userName&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.name}&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><p>Thymeleaf 标准方言将允许我们实现与以下功能相同的功能：:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;userName&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;James Carrot&#34;</span> <span style=color:#c4a000>th:value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.name}&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><p>浏览器不仅可以正确显示这些信息，而且还可以（可选地）在浏览器中静态打开原型时显示的值（可选地）指定一个值属性（在这种情况下为“James Carrot”），将在模板处理期间由<code>${user.name}</code>的计算得到的值代替。</p>
<p>这有助于您的设计师和开发人员处理相同的模板文件，并减少将静态原型转换为工作模板文件所需的工作量。这样的功能是称为 <em>自然模板(Natural Templating)</em> 的功能.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-399b5319f1df6cc8ec7add459d3cb3f7>2 - CH02-使用文本</h1>
<p>先看一个页面示例：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>xmlns:th</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.thymeleaf.org&#34;</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Good Thymes Virtual Grocery<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>http-equiv</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Content-Type&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/html; charset=UTF-8&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/css&#34;</span> <span style=color:#c4a000>media</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;all&#34;</span> 
          <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;../../css/gtvg.css&#34;</span> <span style=color:#c4a000>th:href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;@{/css/gtvg.css}&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{home.welcome}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Welcome to our grocery store!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>首先，注意到的这个文件是HTML5的，可以由任何浏览器正确显示，因为它不包含任何非HTML标签（浏览器会忽略他们所不能理解的属性，如 <code>th:text</code>）。</p>
<p>但是您也可能会注意到，这个模板并不是一个真正有效的HTML5文档，因为HTML5规范不允许在<code>th:*</code>形式中使用这些非标准属性。 事实上，我们甚至在我们的 <code>&lt;html></code> 标签中添加了一个<code>xmlns:th</code> 属性，这也不属于 HTML5 语言：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>xmlns:th</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.thymeleaf.org&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>它在模板处理中根本没有任何影响，但我们的 IDE 会提示诸如“缺少<code>th:*</code>属性命名空间定义”等字样的告警。</p>
<p>如果我们想让这些模板对于 HTML5 验证是有效的，需要做简单地修改，将属性语法，改为<code>data-</code>前缀，(<code>:</code>)改为 (<code>-</code>) 即可：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Good Thymes Virtual Grocery<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>http-equiv</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Content-Type&#34;</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/html; charset=UTF-8&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/css&#34;</span> <span style=color:#c4a000>media</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;all&#34;</span> 
          <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;../../css/gtvg.css&#34;</span> <span style=color:#c4a000>data-th-href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;@{/css/gtvg.css}&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>data-th-text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{home.welcome}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Welcome to our grocery store!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>这样，<code>data-</code>前缀就符合 HTML5 中的规范了。</p>
<p><em>注：在实际开发过程中，由于<code>th:*</code>的辨识度往往必<code>data-th-*</code>这种方式更高，所以很多人仍然是选择使用<code>th:*</code>，这也是可以理解的。本书的示例大多也是采用<code>th:*</code>方式。</em></p>
<h2 id=使用-thtext-和外部化文本>使用 th:text 和外部化文本</h2>
<p>外部化文本是从模板文件中提取模板代码的片段，以便它们可以保存在单独的文件（通常为 <code>.properties</code> 文件）中，并且可以轻松地替换为使用其他语言编写的等效文本（称为国际化或简单的i18n） 。文本的外部化片段通常称为“消息（messages）”。</p>
<p>消息总是具有标识它们的 key，而Thymeleaf允许您指定文本应与 <code>#{...}</code>语法对应的特定消息：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{home.welcome}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Welcome to our grocery store!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>我们在这里可以看到的其实是Thymeleaf标准方言的两个不同功能：</p>
<ul>
<li><code>th:text</code>属性，它评估其值表达式并将结果设置为主机标签的主体，有效地替换了代码中我们看到的“Welcome to our grocery store!”文本。</li>
<li><code>#{home.welcome}</code>表达式指示 <code>th:text</code> 属性使用的文本应该是key 为<code>home.welcome</code> 所对应于的消息。</li>
</ul>
<p>Thymeleaf中外部化文本的位置是完全可配置的，它将取决于正在使用的具体的 <code>org.thymeleaf.messageresolver.IMessageResolver</code>实现。通常，将使用基于 <code>.properties</code>文件的实现，但是如果我们想要（例如）从数据库获取消息，我们可以创建自己的实现。</p>
<p>但是，我们在初始化期间尚未为模板引擎指定消息解析器，这意味着我们的应用程序正在使用由<code>org.thymeleaf.messageresolver.StandardMessageResolver</code>实现的标准消息解析器。</p>
<p>标准消息解析器期望在 <code>/WEB-INF/templates/home.html</code>中找到与该模板相同的文件夹中的属性文件的消息，例如：</p>
<ul>
<li><code>/WEB-INF/templates/home_en.properties</code> 为英文文本</li>
<li><code>/WEB-INF/templates/home_es.properties</code> 西班牙语文本</li>
<li><code>/WEB-INF/templates/home_pt_BR.properties</code>葡萄牙语（巴西）语言</li>
<li><code>/WEB-INF/templates/home.properties</code> 为默认文本（如果语言环境不匹配）</li>
</ul>
<p>我们来看看我们的 <code>home_es.properties</code> 文件:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>home.welcome=¡Bienvenido a nuestra tienda de comestibles!
</code></pre></div><h2 id=上下文>上下文</h2>
<p>为了执行模版，我们创建了<code>HomeController</code>类，它实现了 <code>IGTVGController</code> 接口:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>HomeController</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>IGTVGController</span> <span style=color:#ce5c00;font-weight:700>{</span>

    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>process</span><span style=color:#ce5c00;font-weight:700>(</span>
            <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span>
            <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>ServletContext</span> <span style=color:#000>servletContext</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>ITemplateEngine</span> <span style=color:#000>templateEngine</span><span style=color:#ce5c00;font-weight:700>)</span>
            <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>

        <span style=color:#000>WebContext</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>=</span> 
                <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>WebContext</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>servletContext</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLocale</span><span style=color:#ce5c00;font-weight:700>());</span>

        <span style=color:#000>templateEngine</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>process</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;home&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getWriter</span><span style=color:#ce5c00;font-weight:700>());</span>
    <span style=color:#ce5c00;font-weight:700>}</span>
<span style=color:#ce5c00;font-weight:700>}</span>
</code></pre></div><p>首先是 *上下文（context）*的创建。 Thymeleaf 上下文对象实现了 <code>org.thymeleaf.context.IContext</code>接口。上下文包含了执行模版引擎的所有数据变量 map，同时也引用了外部消息的区域设置。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>IContext</span> <span style=color:#ce5c00;font-weight:700>{</span>

    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Locale</span> <span style=color:#000>getLocale</span><span style=color:#ce5c00;font-weight:700>();</span>
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>containsVariable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>);</span>
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Set</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>String</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>getVariableNames</span><span style=color:#ce5c00;font-weight:700>();</span>
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Object</span> <span style=color:#000>getVariable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>);</span>

<span style=color:#ce5c00;font-weight:700>}</span>
</code></pre></div><p>这个接口有一个专门的扩展，<code>org.thymeleaf.context.IWebContext</code>，用于基于ServletAPI的Web应用程序（如SpringMVC）中。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>IWebContext</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>IContext</span> <span style=color:#ce5c00;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>getRequest</span><span style=color:#ce5c00;font-weight:700>();</span>
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>getResponse</span><span style=color:#ce5c00;font-weight:700>();</span>
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>HttpSession</span> <span style=color:#000>getSession</span><span style=color:#ce5c00;font-weight:700>();</span>
    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>ServletContext</span> <span style=color:#000>getServletContext</span><span style=color:#ce5c00;font-weight:700>();</span>
<span style=color:#ce5c00;font-weight:700>}</span>
</code></pre></div><p>Thymeleaf 核心库提供了这些接口的每个实现:</p>
<ul>
<li><code>org.thymeleaf.context.Context</code> 实现了 <code>IContext</code></li>
<li><code>org.thymeleaf.context.WebContext</code> 实现了 <code>IWebContext</code></li>
</ul>
<p>而在控制器代码中可以看到，<code>WebContext</code>是我们使用的。 实际上我们必须，因为使用一个<code>ServletContextTemplateResolver</code>要求我们使用实现 <code>IWebContext</code> 的上下文。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#000>WebContext</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>WebContext</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>servletContext</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLocale</span><span style=color:#ce5c00;font-weight:700>());</span>
</code></pre></div><p>只需要这四个构造函数参数中的三个，因为如果没有指定，那么将使用系统的默认语言环境（尽管不应该在实际应用程序中发生）。</p>
<p>有一些专门的表达式，能够从我们的模板中的 <code>WebContext</code> 获取请求参数和请求、会话和应用程序属性。 例如：</p>
<ul>
<li><code>${x}</code> 将返回存储在Thymeleaf上下文中的变量 <code>x</code> 或作为 <em>请求属性（request attribute）</em></li>
<li><code>${param.x}</code> 将返回一个名为 <code>x</code>的<em>请求参数（request parameter）</em>（可能是多值的）</li>
<li><code>${session.x}</code> 将返回一个名为 <code>x</code>的 <em>会话属性（session attribute）</em></li>
<li><code>${application.x}</code> 将返回一个名为<code>x</code>的<em>servlet上下文属性 （servlet context attribute）</em></li>
</ul>
<h2 id=执行模版引擎>执行模版引擎</h2>
<p>随着我们的上下文对象准备就绪，现在我们可以告诉模板引擎使用上下文来处理模板（通过它的名字），并传递一个响应写入器，以便可以将响应写入它：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#000>templateEngine</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>process</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;home&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getWriter</span><span style=color:#ce5c00;font-weight:700>());</span>
</code></pre></div><p>在西班牙环境下，输出如下 :</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Good Thymes Virtual Grocery<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/html; charset=UTF-8&#34;</span> <span style=color:#c4a000>http-equiv</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Content-Type&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/css&#34;</span> <span style=color:#c4a000>media</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;all&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/gtvg/css/gtvg.css&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>¡Bienvenido a nuestra tienda de comestibles!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=非转义文本>非转义文本</h2>
<p>如果我们的消息中包含特殊字符，比如html标签，如下</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#000>home</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>welcome</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>Welcome</span> <span style=color:#000>to</span> <span style=color:#000>our</span> <span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>b</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000>fantastic</span><span style=color:#ce5c00;font-weight:700>&lt;/</span><span style=color:#000>b</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>grocery</span> <span style=color:#000>store</span><span style=color:#ce5c00;font-weight:700>!</span>
</code></pre></div><p>那么，执行模版，将会得到如下输出:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Welcome to our <span style=color:#ce5c00>&amp;lt;</span>b<span style=color:#ce5c00>&amp;gt;</span>fantastic<span style=color:#ce5c00>&amp;lt;</span>/b<span style=color:#ce5c00>&amp;gt;</span> grocery store!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>这是<code>th:text</code> 属性的默认行为。 但我们希望 Thymeleaf 能如实输出HTML标签，我们可以使用<code>th:utext</code>，即“unescaped text（非转义文本)”：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>th:utext</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{home.welcome}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Welcome to our grocery store!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>这样就能输出符合我们预期的文本了:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Welcome to our <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>b</span><span style=color:#000;font-weight:700>&gt;</span>fantastic<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>b</span><span style=color:#000;font-weight:700>&gt;</span> grocery store!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=使用和显示变量>使用和显示变量</h2>
<p>我们控制器如下：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>process</span><span style=color:#ce5c00;font-weight:700>(</span>
            <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>HttpServletResponse</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span>
            <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>ServletContext</span> <span style=color:#000>servletContext</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#000>ITemplateEngine</span> <span style=color:#000>templateEngine</span><span style=color:#ce5c00;font-weight:700>)</span>
            <span style=color:#204a87;font-weight:700>throws</span> <span style=color:#000>Exception</span> <span style=color:#ce5c00;font-weight:700>{</span>

    <span style=color:#000>SimpleDateFormat</span> <span style=color:#000>dateFormat</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>SimpleDateFormat</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;dd MMMM yyyy&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
    <span style=color:#000>Calendar</span> <span style=color:#000>cal</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Calendar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getInstance</span><span style=color:#ce5c00;font-weight:700>();</span>

    <span style=color:#000>WebContext</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>=</span> 
            <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>WebContext</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>servletContext</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getLocale</span><span style=color:#ce5c00;font-weight:700>());</span>
    <span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setVariable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;today&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>dateFormat</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>format</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>cal</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getTime</span><span style=color:#ce5c00;font-weight:700>()));</span>

    <span style=color:#000>templateEngine</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>process</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;home&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>ctx</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>response</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getWriter</span><span style=color:#ce5c00;font-weight:700>());</span>

<span style=color:#ce5c00;font-weight:700>}</span>
</code></pre></div><p>添加了一个名为 <code>today</code> 的<code>String</code> 变量到我们的上下文中，我们在模版中显示:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>th:utext</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{home.welcome}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Welcome to our grocery store!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Today is: <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${today}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>13 February 2011<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>

<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>正如你所看到的，我们仍然使用<code>th:text</code>属性，但是这个时候语法有点不同，不是 <code>#{...}</code>，我们使用 <code>${...}</code>。 这是一个变量表达式，它包含一个名为OGNL（Object-Graph Navigation Language）的表达式。</p>
<p><code>${today}</code> 表达式只是意味着“获取名为 today 的变量”，但是这些表达式可能可以更复杂（例如 <code>${user.name}</code> 表示变量为 user的变量，调用其 <code>getName()</code> 方法。</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-6709d6272471dac1238c1b709826b488>3 - CH03-表达式</h1>
<p>Thymeleaf 标准表达式（ Standard Expression）语法，是 Thymeleaf 标准方言（Standard Dialect）的最重要组成部分之一。</p>
<h2 id=标准表达式>标准表达式</h2>
<p>Thymeleaf 提供了多种标准表达式包括：</p>
<ul>
<li>简单表达式：
<ul>
<li>Variable expressions（变量表达式）<code>${...}</code></li>
<li>Selection expressions（选择表达式）<code>*{...}</code></li>
<li>Message (i18n) expressions（消息表达式） <code>#{...}</code></li>
<li>Link (URL) expressions（链接表达式）<code>@{...}</code></li>
<li>Fragment expressions（片段表达式）<code>~{...}</code></li>
</ul>
</li>
<li>字面量:
<ul>
<li>文本：<code>'one text'</code>、<code>'Another one!'</code>等；</li>
<li>数值：0、34、3.0、12.3 等；</li>
<li>布尔：true、false</li>
<li>Null：null</li>
<li>Literal token(字面标记): one、sometext、 main等；</li>
</ul>
</li>
<li>文本操作:
<ul>
<li>字符串拼接：<code>+</code></li>
<li>文本替换：<code>|The name is ${name}|</code></li>
</ul>
</li>
<li>算术操作:
<ul>
<li>二元运算符：<code>+</code>、<code>-</code>、 <code>*</code>、<code>/</code>、<code>%</code></li>
<li>减号（单目运算符）：<code>-</code></li>
</ul>
</li>
<li>布尔操作：
<ul>
<li>二元运算符：<code>and</code>、<code>or</code></li>
<li>布尔否定（一元运算符）：<code>!</code>、<code>not</code></li>
</ul>
</li>
<li>比较和等价：
<ul>
<li>比较：<code>></code>、<code>&lt;</code>、<code>>=</code>、<code>&lt;=</code>（<code>gt</code>、<code>lt</code>、<code>ge</code>、<code>le</code>）</li>
<li>等价:<code>==</code>、<code>!=</code>（<code>eq</code>、<code>ne</code>）</li>
</ul>
</li>
<li>条件运算符：
<ul>
<li>If-then：<code>(if) ? (then)</code></li>
<li>If-then-else：<code>(if) ? (then) : (else)</code></li>
<li>Default：<code>(value) ?: (defaultvalue)</code></li>
</ul>
</li>
<li>特殊标记：
<ul>
<li>No-Operation（无操作）：<code>_</code></li>
</ul>
</li>
</ul>
<p>下面的这个示例，涵盖了上述大部分表达式：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&#39;User is of type &#39; + (${user.isAdmin()} ? &#39;Administrator&#39; : (${user.type}
</code></pre></div><h2 id=消息表达式>消息表达式</h2>
<p>消息表达式（通常称为文本外化、国际化或i18n）允许我们从外部源（<code>.properties</code>文件）检索特定于语言环境的消息，通过 key 引用它们（可选）应用一组参数。</p>
<p>在Spring应用程序中，这将自动与Spring的MessageSource机制集成。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>#{main.title}

#{message.entrycreated(${entryId})}
</code></pre></div><p>在模版中的应用如下：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;table&gt;
  ...
  &lt;th th:text=&#34;#{header.address.city}&#34;&gt;...&lt;/th&gt;
  &lt;th th:text=&#34;#{header.address.country}&#34;&gt;...&lt;/th&gt;
  ...
&lt;/table&gt;
</code></pre></div><p>请注意，如果希望消息 key 由上下文变量的值确定，或者要将变量指定为参数，则可以在消息表达式中使用变量表达式：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>#{${config.adminWelcomeKey}(${session.user.name})}
</code></pre></div><h2 id=变量表达式>变量表达式</h2>
<p>变量表达式可以是OGNL表达式或者是 Spring EL，如果集成了Spring的话，可以在上下文变量（context variables ）中执行。</p>
<blockquote>
<p>有关OGNL语法和功能的详细信息，请阅读<a href=http://commons.apache.org/proper/commons-ognl/>OGNL语言指南</a> 在 Spring MVC 启用的应用程序中，OGNL将被替换为<strong>SpringEL</strong>，但其语法与OGNL非常相似（实际上，在大多数常见情况下完全相同）。</p>
</blockquote>
<p>在Spring术语中，变量表达式也称为模型属性（model attributes）。 他们看起来像这样：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>${session.user.name}
</code></pre></div><p>他们作为属性值或作为属性的一部分：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;span th:text=&#34;${book.author.name}&#34;&gt;
</code></pre></div><p>上面的表达式在在OGNL和SpringEL中等价于：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>((Book)context.getVariable(&#34;book&#34;)).getAuthor().getName()
</code></pre></div><p>这些变量表达式不仅涉及输出，还包括更复杂的处理，如条件判断、迭代等：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;li th:each=&#34;book : ${books}&#34;&gt;
</code></pre></div><p>这里<code>${books}</code>从上下文中选择名为<code>books</code>的变量，并将其评估为可在<code>th:each</code>循环中使用的迭代器（iterable）。</p>
<p>更多 OGNL 的功能有：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#8f5902;font-style:italic>/*
</span><span style=color:#8f5902;font-style:italic> * 使用点(.)来访问属性，等价于调用属性的  getter 
</span><span style=color:#8f5902;font-style:italic> */</span>
<span style=color:#000>$</span><span style=color:#ce5c00;font-weight:700>{</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>father</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>}</span>

<span style=color:#8f5902;font-style:italic>/*
</span><span style=color:#8f5902;font-style:italic> * 访问属性也可以使用([])块
</span><span style=color:#8f5902;font-style:italic> */</span>
<span style=color:#000>$</span><span style=color:#ce5c00;font-weight:700>{</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#a40000>&#39;</span><span style=color:#000>father</span><span style=color:#a40000>&#39;</span><span style=color:#ce5c00;font-weight:700>][</span><span style=color:#a40000>&#39;</span><span style=color:#000>name</span><span style=color:#a40000>&#39;</span><span style=color:#ce5c00;font-weight:700>]}</span>

<span style=color:#8f5902;font-style:italic>/*
</span><span style=color:#8f5902;font-style:italic> * 如果对象是一个map，则点和块语法等价于调用其get(...)方法
</span><span style=color:#8f5902;font-style:italic> */</span>
<span style=color:#000>$</span><span style=color:#ce5c00;font-weight:700>{</span><span style=color:#000>countriesByCode</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>ES</span><span style=color:#ce5c00;font-weight:700>}</span>
<span style=color:#000>$</span><span style=color:#ce5c00;font-weight:700>{</span><span style=color:#000>personsByName</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#a40000>&#39;</span><span style=color:#000>Stephen</span> <span style=color:#000>Zucchini</span><span style=color:#a40000>&#39;</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#c4a000>age</span><span style=color:#ce5c00;font-weight:700>}</span>

<span style=color:#8f5902;font-style:italic>/*
</span><span style=color:#8f5902;font-style:italic> * 在块语法中，也可以通过索引来访问数组或者集合
</span><span style=color:#8f5902;font-style:italic> */</span>
<span style=color:#000>$</span><span style=color:#ce5c00;font-weight:700>{</span><span style=color:#000>personsArray</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>0</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>}</span>

<span style=color:#8f5902;font-style:italic>/*
</span><span style=color:#8f5902;font-style:italic> * 可以调用方法，同时也支持参数
</span><span style=color:#8f5902;font-style:italic> */</span>
<span style=color:#000>$</span><span style=color:#ce5c00;font-weight:700>{</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createCompleteName</span><span style=color:#ce5c00;font-weight:700>()}</span>
<span style=color:#000>$</span><span style=color:#ce5c00;font-weight:700>{</span><span style=color:#000>person</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>createCompleteNameWithSeparator</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#39;-&#39;</span><span style=color:#ce5c00;font-weight:700>)}</span>
</code></pre></div><h2 id=表达式预设对象>表达式预设对象</h2>
<p>当对上下文变量评估 OGNL 表达式时，某些对象可用于表达式以获得更高的灵活性。 这些对象将被引用（按照OGNL标准），以<code>＃</code>符号开始：</p>
<ul>
<li><code>#ctx</code>：上下文对象。</li>
<li><code>#vars</code>：上下文变量。</li>
<li><code>#locale</code>：上下文区域设置。</li>
<li><code>#request</code>:HttpServletRequest 对象(仅在 Web 上下文中）。</li>
<li><code>#response</code>：HttpServletResponse 对象(仅在 Web 上下文中）。</li>
<li><code>#session</code>:HttpSession对象(仅在 Web 上下文中）。</li>
<li><code>#servletContext</code>:ServletContext对象(仅在 Web 上下文中）。</li>
</ul>
<p>所以我们可以这样做：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>Established locale country: <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${#locale.country}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>US<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>.
</code></pre></div><p>完整内容可以参考后文[表达式基本对象]部分。</p>
<h2 id=表达式工具对象>表达式工具对象</h2>
<p>除了上面这些基本的对象之外，Thymeleaf 将为我们提供一组工具对象，这些对象将帮助我们在表达式中执行常见任务：</p>
<ul>
<li><code>#execInfo</code>: 模版执行的信息</li>
<li><code>#messages</code>: 在变量内获取外部消息的方法 表达式，与使用<code>＃{...}</code>语法获得的方式相同。.</li>
<li><code>#uris</code>: 用于转义 URL/URI 部分的方法</li>
<li><code>#conversions</code>: 执行已配置的 <em>conversion service</em></li>
<li><code>#dates</code>: <code>java.util.Date</code>对象的方法，比如格式化，组件提取等</li>
<li><code>#calendars</code>:类似于<code>＃dates</code>，但是对应于<code>java.util.Calendar</code>对象</li>
<li><code>#numbers</code>: 格式化数字对象的方法。</li>
<li><code>#strings</code>: <code>String</code>对象的方法，包括 contains、startsWith、prepending/appending等 等等</li>
<li><code>#objects</code>: 对象通常的方法</li>
<li><code>#bools</code>: 布尔判断的方法</li>
<li><code>#arrays</code>: array 方法</li>
<li><code>#lists</code>: list 方法</li>
<li><code>#sets</code>: set 方法</li>
<li><code>#maps</code>: map 方法</li>
<li><code>#aggregates</code>:在数组或集合上创建聚合的方法</li>
<li><code>#ids</code>: 用于处理可能重复的id属性的方法（例如，作为迭代的结果）。</li>
</ul>
<p>下面是一个格式化日期的例子：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
  Today is: <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${#calendars.format(today,&#39;dd MMMM yyyy&#39;)}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>13 May 2011<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>完整内容可以参考后文[表达式工具对象]部分。</p>
<h2 id=选择表达式>选择表达式</h2>
<p>选择表达式与变量表达式很像，区别在于它们是在当前选择的对象而不是整个上下文变量映射上执行。 他们看起来像这样：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>*{customer.name}
</code></pre></div><p>它们所作用的对象由<code>th:object</code>属性指定：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;div th:object=&#34;${book}&#34;&gt;
  ...
  &lt;span th:text=&#34;*{title}&#34;&gt;...&lt;/span&gt;
  ...
&lt;/div&gt;
</code></pre></div><p>这等价于：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>{
  // th:object=&#34;${book}&#34;
  final Book selection = (Book) context.getVariable(&#34;book&#34;);
  // th:text=&#34;*{title}&#34;
  output(selection.getTitle());
}
</code></pre></div><h2 id=链接表达式>链接表达式</h2>
<p>链接表达式旨在构建 URL 并向其添加有用的上下文和会话信息（通常称为URL重写的过程）。</p>
<p>因此，对于部署在Web服务器的<code>/myapp</code>上下文中的Web应用程序，可以使用以下表达式：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;a th:href=&#34;@{/order/list}&#34;&gt;...&lt;/a&gt;
</code></pre></div><p>可以转成：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;a href=&#34;/myapp/order/list&#34;&gt;...&lt;/a&gt;
</code></pre></div><p>cookie没有启用下，如果我们需要保持会话，可以这样：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;a href=&#34;/myapp/order/list;jsessionid=23fa31abd41ea093&#34;&gt;...&lt;/a&gt;
</code></pre></div><p>URL 可以携带参数：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;a th:href=&#34;@{/order/details(id=${orderId},type=${orderType})}&#34;&gt;...&lt;/a&gt;
</code></pre></div><p>结果如下：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;!-- Note ampersands (&amp;) should be HTML-escaped in tag attributes... --&gt;
&lt;a href=&#34;/myapp/order/details?id=23&amp;amp;type=online&#34;&gt;...&lt;/a&gt;
</code></pre></div><p>链接表达式可以是相对的，在这种情况下，应用程序上下文将不会作为URL的前缀：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;a th:href=&#34;@{../documents/report}&#34;&gt;...&lt;/a&gt;
</code></pre></div><p>也 可以是服务器相对（同样，没有应用程序上下文前缀）：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;a th:href=&#34;@{~/contents/main}&#34;&gt;...&lt;/a&gt;
</code></pre></div><p>和协议相对（就像绝对URL，但浏览器将使用在显示的页面中使用的相同的HTTP或HTTPS协议）：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;a th:href=&#34;@{//static.mycompany.com/res/initial}&#34;&gt;...&lt;/a&gt;
</code></pre></div><p>当然，Link表达式可以是绝对的：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;a th:href=&#34;@{http://www.mycompany.com/main}&#34;&gt;...&lt;/a&gt;
</code></pre></div><blockquote>
<p>在绝对（或协议相对）的URL等里面，Thymeleaf链接表达式添加的是什么值？ 答案是，可能是由响应过滤器定义的URL重写。在基于Servlet的Web应用程序中，对于每个输出的URL（上下文相对、相对、绝对&mldr;）Thymeleaf将总是调用HttpServletResponse.encodeUrl(&mldr;) 机制 在显示URL之前。 这意味着过滤器可以通过包装HttpServletResponse对象（通常使用的机制）来为应用程序执行定制的URL重写。</p>
</blockquote>
<h2 id=片段表达式>片段表达式</h2>
<p>片段表达式是 3.x 版本新增的内容。</p>
<p>片段段表达式是一种表示标记片段并将其移动到模板周围的简单方法。 正是由于这些表达式，片段可以被复制，或者作为参数传递给其他模板等等。</p>
<p>最常见的用法是使用<code>th:insert</code>或<code>th:replace:</code>插入片段：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;div th:insert=&#34;~{commons :: main}&#34;&gt;...&lt;/div&gt;
</code></pre></div><p>但是它们可以在任何地方使用，就像任何其他变量一样：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;div th:with=&#34;frag=~{footer :: #main/text()}&#34;&gt;
  &lt;p th:insert=&#34;${frag}&#34;&gt;
&lt;/div&gt;
</code></pre></div><p>片段表达式可以有参数。</p>
<h2 id=字面量>字面量</h2>
<h3 id=本文>本文</h3>
<p>文本文字只是在单引号之间指定的字符串。 他们可以包含任何字符，但您应该避免其中的任何单引号使用<code>\'</code>。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
  Now you are looking at a <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;&#39;working web application&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>template file<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>.
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h3 id=数字>数字</h3>
<p>数字文字就是数字。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>The year is <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;2013&#34;</span><span style=color:#000;font-weight:700>&gt;</span>1492<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>In two years, it will be <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;2013 + 2&#34;</span><span style=color:#000;font-weight:700>&gt;</span>1494<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h3 id=布尔>布尔</h3>
<p>布尔文字为“true”和“false”。 例如：:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:if</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.isAdmin()} == false&#34;</span><span style=color:#000;font-weight:700>&gt;</span> ...
</code></pre></div><p>在这个例子中，<code>== false</code>写在大括号之外，Thymeleaf 会做处理。如果是写在大括号内，那就是由 OGNL/SpringEL 引擎负责处理：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:if</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.isAdmin() == false}&#34;</span><span style=color:#000;font-weight:700>&gt;</span> ...
</code></pre></div><h3 id=null>null</h3>
<p><code>null</code> 字面量使用如下：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:if</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${variable.something} == null&#34;</span><span style=color:#000;font-weight:700>&gt;</span> ...
</code></pre></div><h3 id=字面量标记>字面量标记</h3>
<p>数字、布尔和 null 字面实际上是*字面量标记(literal tokens)*的特殊情况。</p>
<p>这些标记允许在标准表达式中进行一点简化。 他们工作与文字文字（<code>'...'</code>）完全相同，但只允许使用字母（<code>A-Z</code>）和<code>a-z'），数字（0-9），括号（</code>[<code>和</code>]<code>），点（</code>.<code>），连字符（</code>-<code>） 和下划线（</code>_`）。 所以没有空白，没有逗号等</p>
<p>标记不需任何引号。 所以我们可以这样做：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;content&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>用来代替:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;&#39;content&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=附加文本>附加文本</h2>
<p>无论是文字，还是评估变量或消息表达式的结果，都可以使用　<code>+</code> 操作符轻松地附加文本： 　</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;&#39;The name of the user is &#39; + ${user.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=字面量替换>字面量替换</h2>
<p>字面量替换允许容易地格式化包含变量值的字符串，而不需要使用 <code>'...' + '...'</code>附加文字。</p>
<p>这些替换必须被(<code>|</code>)包围，如：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;|Welcome to our application, ${user.name}!|&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>其等价于：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;&#39;Welcome to our application, &#39; + ${user.name} + &#39;!&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>字面量替换可以与其他类型的表达式相结合：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${onevar} + &#39; &#39; + |${twovar}, ${threevar}|&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><blockquote>
<p><code>|...|</code> 字面量替换只允许使用变量/消息表达式(<code>${...}</code>, <code>*{...}</code>, <code>#{...}</code>)， 其他字面量 (<code>'...'</code>)、布尔/数字标记、条件表达式等是不允许的</p>
</blockquote>
<h2 id=算术运算>算术运算</h2>
<p>支持算术运算：<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> 和 <code>%</code>。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:with</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;isEven=(${prodStat.count} % 2 == 0)&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>请注意，这些运算符也可以在OGNL变量表达式本身中应用（在这种情况下将由OGNL执行，而不是Thymeleaf标准表达式引擎）：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:with</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;isEven=${prodStat.count % 2 == 0}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>请注意，其中一些运算符存在文本别名：<code>div</code> (<code>/</code>)、 <code>mod</code> (<code>%</code>)。</p>
<h2 id=比较与相等>比较与相等</h2>
<p>表达式中的值可以与<code>></code>, <code>&lt;</code>, <code>>=</code> 和 <code>&lt;=</code> 号进行比较，并且可以使用<code>==</code> 和 <code>!=</code> 运算符来检查是否相等。 请注意， <code>&lt;</code> 和 <code>></code>符号不应该在XML属性值中使用，因此它们应被替换为<code>&lt;</code> 和<code>></code>。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:if</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${prodStat.count} &amp;gt; 1&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;&#39;Execution mode is &#39; + ( (${execMode} == &#39;dev&#39;)? &#39;Development&#39; : &#39;Production&#39;)&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>一个更简单的替代方案可能是使用一些这些运算符存在的文本别名：<code>gt</code> (<code>></code>), <code>lt</code> (<code>&lt;</code>), <code>ge</code> (<code>>=</code>), <code>le</code> (<code>&lt;=</code>), <code>not</code> (<code>!</code>). <code>eq</code> (<code>==</code>), <code>neq</code>/<code>ne</code> (<code>!=</code>)</p>
<h2 id=条件表达式>条件表达式</h2>
<p>条件表达式仅用于评估两个表达式中的一个，这取决于评估条件（本身就是另一个表达式）的结果。</p>
<p>我们来看一个示例 <code>th:class</code> 片段 ：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>th:class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${row.even}? &#39;even&#39; : &#39;odd&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  ...
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>条件表达式（condition，then和else）的所有三个部分都是自己的表达式，这意味着它们可以是变量(<code>${...}</code>, <code>*{...}</code>)，消息 (<code>#{...}</code>) ，(<code>@{...}</code>) 或字面量(<code>'...'</code>)。</p>
<p>条件表达式也可以使用括号嵌套：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>th:class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${row.even}? (${row.first}? &#39;first&#39; : &#39;even&#39;) : &#39;odd&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  ...
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>else表达式也可以省略，在这种情况下，如果条件为false，则返回null值：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>th:class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${row.even}? &#39;alt&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  ...
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=默认表达式>默认表达式</h2>
<p><em>默认表达式(default expression)<em>是一种特殊的条件值，没有</em>then</em> 部分。它相当于某些语言中的<em>Elvis operator</em>存在，比如 Groovy。指定两个表达式，如果第一个不是 null，则使用第二个。</p>
<p>查看如下示例：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:object</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${session.user}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  ...
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Age: <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;*{age}?: &#39;(no age specified)&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>27<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>这相当于：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Age: <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;*{age != null}? *{age} : &#39;(no age specified)&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>27<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>.<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>与条件表达式一样，它们之间可以包含嵌套表达式：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
  Name: 
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;*{firstName}?: (*{admin}? &#39;Admin&#39; : #{default.username})&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Sebastian<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=无操作标记>无操作标记</h2>
<p>无操作标记由下划线符号（<code>_</code>）表示。表示什么也不做，这允许开发人员使用原型中的文本默认值。 例如，：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.name} ?: &#39;no user authenticated&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>我们可以直接使用*&lsquo;no user authenticated&rsquo;* 作为原型文本，这样代码从设计的角度来看起来很简洁：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.name} ?: _&#34;</span><span style=color:#000;font-weight:700>&gt;</span>no user authenticated<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=数据转换及格式化>数据转换及格式化</h2>
<p>Thymeleaf 的双大括号为变量表达式（<code>$ {...}</code>）和选择表达式（<code>* {...}</code>）提供了数据<em>转换服务</em>：</p>
<p>它看上去是这样的：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${{user.lastAccessDate}}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>注意到双括号吗？：<code>$ {{...}}</code>。这意味着Thymeleaf可以通过转换服务将结果转换为<code>String</code>。</p>
<p>假设<code>user.lastAccessDate</code>类型为<code>java.util.Calendar</code>，如果<em>转换服务</em> （“IStandardConversionService”的实现）已经被注册并且包含有效的<code>Calendar - > String</code>的 转换，则它将被应用。</p>
<p>“IStandardConversionService”（“StandardConversionService”）的默认实现类）只需在转换为“String”的任何对象上执行<code>.toString()</code>。有关更多信息如何注册一个自定义<em>转换服务</em>实现，看看[更多配置]（＃more-on-configuration）部分。</p>
<h2 id=表达式预处理>表达式预处理</h2>
<p>表达式预处理（expression preprocessing），它被定义在下划线<code>_</code>之间：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>#{selection.__${sel.code}__}
</code></pre></div><p>我们看到的变量表达式<code>${sel.code}</code>将先被执行，假如结果是<code>"ALL"</code>，那么_之间的值<code>"ALL"</code>将被看做表达式的一部分被执行，在这里会变成<code>selection.ALL</code>。</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-b6f300e1180704988751105f265cb623>4 - CH04-设置属性值</h1>
<h2 id=设置任意属性值>设置任意属性值</h2>
<p><code>th:attr</code> 用于设置属性：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form</span> <span style=color:#c4a000>action</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;subscribe.html&#34;</span> <span style=color:#c4a000>th:attr</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;action=@{/subscribe}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>fieldset</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;email&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Subscribe!&#34;</span> <span style=color:#c4a000>th:attr</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value=#{subscribe.submit}&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>fieldset</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>form</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p><code>th:attr</code>会将表达式的结果，设置到相应的属性中去。上面模板结果如下：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form</span> <span style=color:#c4a000>action</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/gtvg/subscribe&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>fieldset</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;email&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;¡Suscríbe!&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>fieldset</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>form</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>我们也能同时设置多个属性值：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>img</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;../../images/gtvglogo.png&#34;</span> 
     <span style=color:#c4a000>th:attr</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;src=@{/images/gtvglogo.png},title=#{logo},alt=#{logo}&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><p>输出如下:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>img</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/gtgv/images/gtvglogo.png&#34;</span> <span style=color:#c4a000>title</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Logo de Good Thymes&#34;</span> <span style=color:#c4a000>alt</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Logo de Good Thymes&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><h2 id=设置值到指定的属性>设置值到指定的属性</h2>
<p>现在，你可能会想到像：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Subscribe!&#34;</span> <span style=color:#c4a000>th:attr</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value=#{subscribe.submit}&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><p>上面可以指定一个属性的值，但看上去有点丑陋，且并不是最优雅的方式。 通常，你将使用其他任务的<code>th：*</code>属性 设置特定的标签属性（而不仅仅是像“th：attr”这样的任意属性）。</p>
<p>例如，要设置<code>value</code>属性，使用<code>th：value</code>：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Subscribe!&#34;</span> <span style=color:#c4a000>th:value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{subscribe.submit}&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><p>要设置 <code>action</code> 属性，使用<code>th:action</code>：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form</span> <span style=color:#c4a000>action</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;subscribe.html&#34;</span> <span style=color:#c4a000>th:action</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;@{/subscribe}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>Thymeleaf 提供了很多属性，每个都针对特定的HTML5属性：</p>
<table>
<thead>
<tr>
<th><code>th:abbr</code></th>
<th><code>th:accept</code></th>
<th><code>th:accept-charset</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>th:accesskey</code></td>
<td><code>th:action</code></td>
<td><code>th:align</code></td>
</tr>
<tr>
<td><code>th:alt</code></td>
<td><code>th:archive</code></td>
<td><code>th:audio</code></td>
</tr>
<tr>
<td><code>th:autocomplete</code></td>
<td><code>th:axis</code></td>
<td><code>th:background</code></td>
</tr>
<tr>
<td><code>th:bgcolor</code></td>
<td><code>th:border</code></td>
<td><code>th:cellpadding</code></td>
</tr>
<tr>
<td><code>th:cellspacing</code></td>
<td><code>th:challenge</code></td>
<td><code>th:charset</code></td>
</tr>
<tr>
<td><code>th:cite</code></td>
<td><code>th:class</code></td>
<td><code>th:classid</code></td>
</tr>
<tr>
<td><code>th:codebase</code></td>
<td><code>th:codetype</code></td>
<td><code>th:cols</code></td>
</tr>
<tr>
<td><code>th:colspan</code></td>
<td><code>th:compact</code></td>
<td><code>th:content</code></td>
</tr>
<tr>
<td><code>th:contenteditable</code></td>
<td><code>th:contextmenu</code></td>
<td><code>th:data</code></td>
</tr>
<tr>
<td><code>th:datetime</code></td>
<td><code>th:dir</code></td>
<td><code>th:draggable</code></td>
</tr>
<tr>
<td><code>th:dropzone</code></td>
<td><code>th:enctype</code></td>
<td><code>th:for</code></td>
</tr>
<tr>
<td><code>th:form</code></td>
<td><code>th:formaction</code></td>
<td><code>th:formenctype</code></td>
</tr>
<tr>
<td><code>th:formmethod</code></td>
<td><code>th:formtarget</code></td>
<td><code>th:fragment</code></td>
</tr>
<tr>
<td><code>th:frame</code></td>
<td><code>th:frameborder</code></td>
<td><code>th:headers</code></td>
</tr>
<tr>
<td><code>th:height</code></td>
<td><code>th:high</code></td>
<td><code>th:href</code></td>
</tr>
<tr>
<td><code>th:hreflang</code></td>
<td><code>th:hspace</code></td>
<td><code>th:http-equiv</code></td>
</tr>
<tr>
<td><code>th:icon</code></td>
<td><code>th:id</code></td>
<td><code>th:inline</code></td>
</tr>
<tr>
<td><code>th:keytype</code></td>
<td><code>th:kind</code></td>
<td><code>th:label</code></td>
</tr>
<tr>
<td><code>th:lang</code></td>
<td><code>th:list</code></td>
<td><code>th:longdesc</code></td>
</tr>
<tr>
<td><code>th:low</code></td>
<td><code>th:manifest</code></td>
<td><code>th:marginheight</code></td>
</tr>
<tr>
<td><code>th:marginwidth</code></td>
<td><code>th:max</code></td>
<td><code>th:maxlength</code></td>
</tr>
<tr>
<td><code>th:media</code></td>
<td><code>th:method</code></td>
<td><code>th:min</code></td>
</tr>
<tr>
<td><code>th:name</code></td>
<td><code>th:onabort</code></td>
<td><code>th:onafterprint</code></td>
</tr>
<tr>
<td><code>th:onbeforeprint</code></td>
<td><code>th:onbeforeunload</code></td>
<td><code>th:onblur</code></td>
</tr>
<tr>
<td><code>th:oncanplay</code></td>
<td><code>th:oncanplaythrough</code></td>
<td><code>th:onchange</code></td>
</tr>
<tr>
<td><code>th:onclick</code></td>
<td><code>th:oncontextmenu</code></td>
<td><code>th:ondblclick</code></td>
</tr>
<tr>
<td><code>th:ondrag</code></td>
<td><code>th:ondragend</code></td>
<td><code>th:ondragenter</code></td>
</tr>
<tr>
<td><code>th:ondragleave</code></td>
<td><code>th:ondragover</code></td>
<td><code>th:ondragstart</code></td>
</tr>
<tr>
<td><code>th:ondrop</code></td>
<td><code>th:ondurationchange</code></td>
<td><code>th:onemptied</code></td>
</tr>
<tr>
<td><code>th:onended</code></td>
<td><code>th:onerror</code></td>
<td><code>th:onfocus</code></td>
</tr>
<tr>
<td><code>th:onformchange</code></td>
<td><code>th:onforminput</code></td>
<td><code>th:onhashchange</code></td>
</tr>
<tr>
<td><code>th:oninput</code></td>
<td><code>th:oninvalid</code></td>
<td><code>th:onkeydown</code></td>
</tr>
<tr>
<td><code>th:onkeypress</code></td>
<td><code>th:onkeyup</code></td>
<td><code>th:onload</code></td>
</tr>
<tr>
<td><code>th:onloadeddata</code></td>
<td><code>th:onloadedmetadata</code></td>
<td><code>th:onloadstart</code></td>
</tr>
<tr>
<td><code>th:onmessage</code></td>
<td><code>th:onmousedown</code></td>
<td><code>th:onmousemove</code></td>
</tr>
<tr>
<td><code>th:onmouseout</code></td>
<td><code>th:onmouseover</code></td>
<td><code>th:onmouseup</code></td>
</tr>
<tr>
<td><code>th:onmousewheel</code></td>
<td><code>th:onoffline</code></td>
<td><code>th:ononline</code></td>
</tr>
<tr>
<td><code>th:onpause</code></td>
<td><code>th:onplay</code></td>
<td><code>th:onplaying</code></td>
</tr>
<tr>
<td><code>th:onpopstate</code></td>
<td><code>th:onprogress</code></td>
<td><code>th:onratechange</code></td>
</tr>
<tr>
<td><code>th:onreadystatechange</code></td>
<td><code>th:onredo</code></td>
<td><code>th:onreset</code></td>
</tr>
<tr>
<td><code>th:onresize</code></td>
<td><code>th:onscroll</code></td>
<td><code>th:onseeked</code></td>
</tr>
<tr>
<td><code>th:onseeking</code></td>
<td><code>th:onselect</code></td>
<td><code>th:onshow</code></td>
</tr>
<tr>
<td><code>th:onstalled</code></td>
<td><code>th:onstorage</code></td>
<td><code>th:onsubmit</code></td>
</tr>
<tr>
<td><code>th:onsuspend</code></td>
<td><code>th:ontimeupdate</code></td>
<td><code>th:onundo</code></td>
</tr>
<tr>
<td><code>th:onunload</code></td>
<td><code>th:onvolumechange</code></td>
<td><code>th:onwaiting</code></td>
</tr>
<tr>
<td><code>th:optimum</code></td>
<td><code>th:pattern</code></td>
<td><code>th:placeholder</code></td>
</tr>
<tr>
<td><code>th:poster</code></td>
<td><code>th:preload</code></td>
<td><code>th:radiogroup</code></td>
</tr>
<tr>
<td><code>th:rel</code></td>
<td><code>th:rev</code></td>
<td><code>th:rows</code></td>
</tr>
<tr>
<td><code>th:rowspan</code></td>
<td><code>th:rules</code></td>
<td><code>th:sandbox</code></td>
</tr>
<tr>
<td><code>th:scheme</code></td>
<td><code>th:scope</code></td>
<td><code>th:scrolling</code></td>
</tr>
<tr>
<td><code>th:size</code></td>
<td><code>th:sizes</code></td>
<td><code>th:span</code></td>
</tr>
<tr>
<td><code>th:spellcheck</code></td>
<td><code>th:src</code></td>
<td><code>th:srclang</code></td>
</tr>
<tr>
<td><code>th:standby</code></td>
<td><code>th:start</code></td>
<td><code>th:step</code></td>
</tr>
<tr>
<td><code>th:style</code></td>
<td><code>th:summary</code></td>
<td><code>th:tabindex</code></td>
</tr>
<tr>
<td><code>th:target</code></td>
<td><code>th:title</code></td>
<td><code>th:type</code></td>
</tr>
<tr>
<td><code>th:usemap</code></td>
<td><code>th:value</code></td>
<td><code>th:valuetype</code></td>
</tr>
<tr>
<td><code>th:vspace</code></td>
<td><code>th:width</code></td>
<td><code>th:wrap</code></td>
</tr>
<tr>
<td><code>th:xmlbase</code></td>
<td><code>th:xmllang</code></td>
<td><code>th:xmlspace</code></td>
</tr>
</tbody>
</table>
<h2 id=同时设置多个值>同时设置多个值</h2>
<p><code>th:alt-title</code> 和 <code>th:lang-xmllang</code> 是两个特殊的属性，可以同时设置同一个值到两个属性：</p>
<ul>
<li><code>th:alt-title</code> 用于设置 <code>alt</code> 和 <code>title</code></li>
<li><code>th:lang-xmllang</code> 用于设置 <code>lang</code> 和 <code>xml:lang</code></li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>img</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;../../images/gtvglogo.png&#34;</span> 
     <span style=color:#c4a000>th:attr</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;src=@{/images/gtvglogo.png},title=#{logo},alt=#{logo}&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><p>等价于:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>img</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;../../images/gtvglogo.png&#34;</span> 
     <span style=color:#c4a000>th:src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;@{/images/gtvglogo.png}&#34;</span> <span style=color:#c4a000>th:alt-title</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{logo}&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><p>最终结果都是：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>img</span> <span style=color:#c4a000>src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;../../images/gtvglogo.png&#34;</span> 
     <span style=color:#c4a000>th:src</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;@{/images/gtvglogo.png}&#34;</span> <span style=color:#c4a000>th:title</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{logo}&#34;</span> <span style=color:#c4a000>th:alt</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{logo}&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><h2 id=附加和添加前缀>附加和添加前缀</h2>
<p><code>th:attrappend</code> 和 <code>th:attrprepend</code> 用于附加和添加前缀属性。例如</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Do it!&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn&#34;</span> <span style=color:#c4a000>th:attrappend</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;class=${&#39; &#39; + cssStyle}&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><p>执行模版， <code>cssStyle</code> 变量设置为 <code>"warning"</code>时，输出如下：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Do it!&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn warning&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><p>同时，有 <code>th:classappend</code> 和 <code>th:styleappend</code> 用于设置CSS 的 class 和 style。例如：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>th:each</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;prod : ${prods}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;row&#34;</span> <span style=color:#c4a000>th:classappend</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${prodStat.odd}? &#39;odd&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=固定值布尔属性>固定值布尔属性</h2>
<p>HTML具有布尔属性的概念，没有值的属性意味着该值为“true”。 在XHTML中，这些属性只取一个值，即它本身。</p>
<p>例如，<code>checked</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;option2&#34;</span> <span style=color:#c4a000>checked</span> <span style=color:#000;font-weight:700>/&gt;</span> <span style=color:#8f5902;font-style:italic>&lt;!-- HTML --&gt;</span>
<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;option1&#34;</span> <span style=color:#c4a000>checked</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checked&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span> <span style=color:#8f5902;font-style:italic>&lt;!-- XHTML --&gt;</span>
</code></pre></div><p>标准方言包括允许您通过评估条件来设置这些属性，如果评估为true，则该属性将被设置为其固定值，如果评估为false，则不会设置该属性：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;active&#34;</span> <span style=color:#c4a000>th:checked</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.active}&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</code></pre></div><p>标准方言中存在以下固定值布尔属性：</p>
<table>
<thead>
<tr>
<th><code>th:async</code></th>
<th><code>th:autofocus</code></th>
<th><code>th:autoplay</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>th:checked</code></td>
<td><code>th:controls</code></td>
<td><code>th:declare</code></td>
</tr>
<tr>
<td><code>th:default</code></td>
<td><code>th:defer</code></td>
<td><code>th:disabled</code></td>
</tr>
<tr>
<td><code>th:formnovalidate</code></td>
<td><code>th:hidden</code></td>
<td><code>th:ismap</code></td>
</tr>
<tr>
<td><code>th:loop</code></td>
<td><code>th:multiple</code></td>
<td><code>th:novalidate</code></td>
</tr>
<tr>
<td><code>th:nowrap</code></td>
<td><code>th:open</code></td>
<td><code>th:pubdate</code></td>
</tr>
<tr>
<td><code>th:readonly</code></td>
<td><code>th:required</code></td>
<td><code>th:reversed</code></td>
</tr>
<tr>
<td><code>th:scoped</code></td>
<td><code>th:seamless</code></td>
<td><code>th:selected</code></td>
</tr>
</tbody>
</table>
<h2 id=默认属性处理器>默认属性处理器</h2>
<p>提供 “默认属性处理器（default attribute processor）”，当标准方言没有提供的属性时，也可以设置其属性。比如：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:whatever</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p><code>th:whatever</code> 不是标准方言中提供的属性，则最终输出如下:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>whatever</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;John Apricot&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=支持对html5-友好的属性及元素名称>支持对HTML5 友好的属性及元素名称</h2>
<p><code>data-{prefix}-{name}</code>语法在HTML5中编写自定义属性的标准方式，不需要开发人员使用任何名称空间的名字，如<code>th：*</code>。 Thymeleaf使这种语法自动提供给所有的方言（而不只是标准方言）。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>data-th-each</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;user : ${users}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>data-th-text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.login}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>data-th-text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-18723f42642cdfaa0bb50c09f8c2f183>5 - CH05-迭代器</h1>
<h2 id=基本的迭>基本的迭</h2>
<p><code>th:each</code>将循环 array 或 list 中的元素并重复打印一组标签，语法相当于 Java foreach 表达式：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;li th:each=&#34;book : ${books}&#34; th:text=&#34;${book.title}&#34;&gt;En las Orillas del Sar&lt;/li&gt;
</code></pre></div><p>可以使用<code>th：each</code>属性进行遍历的对象包括：</p>
<ul>
<li>任何实现<code>java.util.Iterable</code>的对象</li>
<li>任何实现<code>java.util.Enumeration</code>的对象</li>
<li>任何实现<code>java.util.Iterator</code>的对象，其值将被迭代器返回，而不需要在内存中缓存所有的值</li>
<li>任何实现<code>java.util.Map</code>的对象。 迭代映射时，迭代变量 将是<code>java.util.Map.Entry</code>类</li>
<li>任何数组</li>
<li>任何其他对象将被视为包含对象本身的单值列表</li>
</ul>
<h2 id=状态变量>状态变量</h2>
<p>Thymeleaf 提供 <em>状态变量（status variable）</em> 来跟踪迭代器的状态。</p>
<p><code>th:each</code>属性中，定义了如下状态变量：</p>
<ul>
<li><code>index</code> 属性是当前 <em>迭代器索引（iteration index）</em>，从0开始</li>
<li><code>count</code> 属性是当前 <em>迭代器索引（iteration index）</em>，从1开始</li>
<li><code>size</code> 属性是迭代器元素的总数</li>
<li><code>current</code> 是当前 <em>迭代变量（iter variable）</em></li>
<li><code>even/odd</code> 判断当前迭代器是否是 even 或 odd</li>
<li><code>first</code> 判断当前迭代器是否是第一个</li>
<li><code>last</code> 判断当前迭代器是否是最后</li>
</ul>
<p>看下面的例子：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>NAME<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>PRICE<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>IN STOCK<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>th:each</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;prod,iterStat : ${prods}&#34;</span> <span style=color:#c4a000>th:class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${iterStat.odd}? &#39;odd&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${prod.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Onions<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${prod.price}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>2.41<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${prod.inStock}? #{true} : #{false}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>yes<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>状态变量（在本示例中为“iterStat”）在<code>th：each</code>中定义了。</p>
<p>我们来看看模板的处理后的结果：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>

<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>Good Thymes Virtual Grocery<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>title</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>meta</span> <span style=color:#c4a000>content</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/html; charset=UTF-8&#34;</span> <span style=color:#c4a000>http-equiv</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Content-Type&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>link</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;stylesheet&#34;</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text/css&#34;</span> <span style=color:#c4a000>media</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;all&#34;</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/gtvg/css/gtvg.css&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>head</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>

    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h1</span><span style=color:#000;font-weight:700>&gt;</span>Product list<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h1</span><span style=color:#000;font-weight:700>&gt;</span>

    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>NAME<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>PRICE<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>IN STOCK<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;odd&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>Fresh Sweet Basil<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>4.99<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>yes<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>Italian Tomato<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>1.25<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>no<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;odd&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>Yellow Bell Pepper<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>2.50<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>yes<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>Old Cheddar<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>18.75<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>yes<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>

    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/gtvg/&#34;</span> <span style=color:#c4a000>shape</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;rect&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Return to home<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>

<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>请注意，我们的迭代状态变量已经运行良好，建立只有奇数行具有 “odd” CSS 类。</p>
<p>如果您没有明确设置状态变量，则 Thymeleaf 将始终创建一个状态变量，可以通过后缀“Stat”获取到迭代变量的名称：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>NAME<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>PRICE<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>IN STOCK<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>th:each</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;prod : ${prods}&#34;</span> <span style=color:#c4a000>th:class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${prodStat.odd}? &#39;odd&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${prod.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Onions<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${prod.price}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>2.41<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${prod.inStock}? #{true} : #{false}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>yes<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-656df381e4d5a32cee976c78a557d4ee>6 - CH06-条件语句</h1>
<h2 id=if-和-unless>&ldquo;if&rdquo; 和 &ldquo;unless&rdquo;</h2>
<p><code>th:if</code> 属性用法如下：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;comments.html&#34;</span>
   <span style=color:#c4a000>th:href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;@{/product/comments(prodId=${prod.id})}&#34;</span> 
   <span style=color:#c4a000>th:if</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${not #lists.isEmpty(prod.comments)}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>view<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>请注意，<code>th:if</code> 属性不仅是将评估布尔条件。 它的功能有点超出这一点，它将按照这些规则评估指定的表达式：</p>
<ul>
<li>如果值不为 null：
<ul>
<li>如果值为布尔值，则为true。</li>
<li>如果值是数字，并且不为零</li>
<li>如果值是一个字符且不为零</li>
<li>如果value是String，而不是“false”，“off”或“no”</li>
<li>如果值不是布尔值，数字，字符或字符串。</li>
</ul>
</li>
<li>如果值为null，则th：if 将为 false。</li>
</ul>
<p>另外，<code>th:if</code>有一个相反的属性<code>th:unless</code>，前面的例子改为：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;comments.html&#34;</span>
   <span style=color:#c4a000>th:href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;@{/comments(prodId=${prod.id})}&#34;</span> 
   <span style=color:#c4a000>th:unless</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${#lists.isEmpty(prod.comments)}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>view<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=switch-语句>switch 语句</h2>
<p>switch 语句使用<code>th:switch</code> / <code>th:case</code> 属性集合来实现：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:switch</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.role}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>th:case</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;&#39;admin&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>User is an administrator<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>th:case</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{roles.manager}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>User is a manager<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>请注意，只要一个<code>th：case</code>属性被评估为&rsquo;true'，每个其他同一个 switch 语句中的<code>th：case</code>属性将被评估为<code>false</code>。</p>
<p><code>th:case="*"</code>来设置默认选项：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:switch</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.role}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>th:case</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;&#39;admin&#39;&#34;</span><span style=color:#000;font-weight:700>&gt;</span>User is an administrator<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>th:case</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;#{roles.manager}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>User is a manager<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>th:case</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;*&#34;</span><span style=color:#000;font-weight:700>&gt;</span>User is some other thing<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-819a0eba1a94261161b32081fb1869e1>7 - CH07-模板布局</h1>
<h2 id=包含模板片段>包含模板片段</h2>
<h3 id=定义和引用片段>定义和引用片段</h3>
<p>在我们的模板中，我们经常需要从其他模板中添加 html 页面片段，如页脚、标题、菜单&mldr;</p>
<p>为了做到这一点，Thymeleaf 需要我们来定义这些“片段”，可以使用<code>th：fragment</code>属性来完成。我们定义了<code>/WEB-INF/templates/footer.html</code>页面</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#8f5902;font-style:italic>&lt;!DOCTYPE html&gt;</span>
<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span> <span style=color:#c4a000>xmlns:th</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;http://www.thymeleaf.org&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>

    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:fragment</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;copy&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#ce5c00>&amp;copy;</span> 2017 <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://waylau.com&#34;</span><span style=color:#000;font-weight:700>&gt;</span>waylau.com<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>如果，我们想引用这个 <code>copy</code> 代码片段，我们可以用 <code>th:insert</code> 或 <code>th:replace</code> 属性 (<code>th:include</code> 也是可以，但自 Thymeleaf 3.0 以来就不再推荐):</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>

  ...

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:insert</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;~{footer :: copy}&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>

<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>注意<code>th：insert</code>需要一个<em>片段表达式</em>（<code>〜{...}</code>）。 在上面的例子中，非复杂<em>片段表达式</em>，（<code>〜{</code>，<code>}</code>）包围是完全可选，所以上面的代码将等效于：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>

  ...

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:insert</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;footer :: copy&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>

<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h3 id=片段规范语法>片段规范语法</h3>
<ul>
<li><code>"~{templatename::selector}"</code> 名为<code>templatename</code>的模板上的指定标记选择器。 <code>selector</code>可以只是一个片段名。</li>
<li><code>"~{templatename}"</code> ： 包含完整的模版 <code>templatename</code></li>
<li><code>~{::selector}"</code> or <code>"~{this::selector}"</code> 相同模版中的代码片段</li>
</ul>
<h3 id=不使用-thfragment>不使用 <code>th:fragment</code></h3>
<p>不使用 <code>th:fragment</code>也可以引用HTML片段，比如：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>...
<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;copy-section&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#ce5c00>&amp;copy;</span> 2017 <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://waylau.com&#34;</span><span style=color:#000;font-weight:700>&gt;</span>waylau.com<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
...
</code></pre></div><p>通过 id 也可以引用到页面片段:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>

  ...

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:insert</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;~{footer :: #copy-section}&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>

<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h3 id=thinsert-threplace-thinclude三者区别><code>th:insert</code>、 <code>th:replace</code> 、<code>th:include</code>三者区别</h3>
<ul>
<li><code>th：insert</code>是最简单的：它将简单地插入指定的片段作为正文 的主标签。</li>
<li><code>th：replace</code>用指定实际片段来替换其主标签。</li>
<li><code>th：include</code>类似于<code>th：insert</code>，但不是插入片段它只插入此片段的<em>内容</em>。</li>
</ul>
<p>所以</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>footer</span> <span style=color:#c4a000>th:fragment</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;copy&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#ce5c00>&amp;copy;</span> 2017 <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://waylau.com&#34;</span><span style=color:#000;font-weight:700>&gt;</span>waylau.com<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>footer</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>三种方式引用该片段</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>

  ...

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:insert</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;footer :: copy&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:replace</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;footer :: copy&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:include</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;footer :: copy&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>

<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>结果为：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>

  ...

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>footer</span><span style=color:#000;font-weight:700>&gt;</span>
      <span style=color:#ce5c00>&amp;copy;</span> 2017 <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://waylau.com&#34;</span><span style=color:#000;font-weight:700>&gt;</span>waylau.com<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>footer</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>footer</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#ce5c00>&amp;copy;</span> 2017 <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://waylau.com&#34;</span><span style=color:#000;font-weight:700>&gt;</span>waylau.com<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>footer</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#ce5c00>&amp;copy;</span> 2017 <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>href</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://waylau.com&#34;</span><span style=color:#000;font-weight:700>&gt;</span>waylau.com<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>

<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-912caea4dafa19f95e7b88f898f02ef8>8 - CH08-局部变量</h1>
<p>在迭代器中，我们可以使用局部变量<code>prod</code>：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>th:each</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;prod : ${prods}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    ...
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>Thymeleaf 为您提供了一种在不使用迭代的情况下声明局部变量的方法<code>th：with</code>属性，其语法与属性值类似：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:with</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;firstPer=${persons[0]}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
    The name of the first person is <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${firstPer.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Julius Caesar<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>.
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>当<code>th：with</code>被处理时，<code>firstPer</code>变量创建为局部变量，并添加到来自上下文的变量 map 中，以便它是可用于评估以及在上下文中声明的任何其他变量，但只能在包含<code>&lt;div></code>标签的范围内。</p>
<p>可以同时定义多个变量，赋值语法为：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:with</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;firstPer=${persons[0]},secondPer=${persons[1]}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
    The name of the first person is <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${firstPer.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Julius Caesar<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>.
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
    But the name of the second person is 
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${secondPer.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Marcus Antonius<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>.
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p><code>th：with</code>属性允许重用在同一属性中定义的变量：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:with</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;company=${user.company + &#39; Co.&#39;},account=${accounts[company]}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-1fa293f76e8532b99774044f0a643a63>9 - CH09-属性优先级</h1>
<p>当在同一个标签中写入多个<code>th:*</code>属性时，会发生什么？ 对于下面的例子：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>ul</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span> <span style=color:#c4a000>th:each</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;item : ${items}&#34;</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${item.description}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    Item description here...   
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>ul</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>我们期望<code>th:each</code>属性在<code>th:text</code>之前执行，从而可以得到了我们想要的结果，但是鉴于 HTML/XML标准并未对标签中的属性的顺序给出任何的定义，所以必须在属性中建立*优先级（precedence）*机制 以确保这将按预期工作。</p>
<p>所以，所有的Thymeleaf属性定义一个数字优先级，它建立了它们在标签中执行的顺序。 这个是列表：</p>
<table>
<thead>
<tr>
<th style=text-align:left>Order</th>
<th style=text-align:left>Feature</th>
<th style=text-align:left>Attributes</th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:left>1</td>
<td style=text-align:left>Fragment inclusion</td>
<td style=text-align:left><code>th:insert</code> <code>th:replace</code></td>
</tr>
<tr>
<td style=text-align:left>2</td>
<td style=text-align:left>Fragment iteration</td>
<td style=text-align:left><code>th:each</code></td>
</tr>
<tr>
<td style=text-align:left>3</td>
<td style=text-align:left>Conditional evaluation</td>
<td style=text-align:left><code>th:if</code> <code>th:unless</code> <code>th:switch</code> <code>th:case</code></td>
</tr>
<tr>
<td style=text-align:left>4</td>
<td style=text-align:left>Local variable definition</td>
<td style=text-align:left><code>th:object</code> <code>th:with</code></td>
</tr>
<tr>
<td style=text-align:left>5</td>
<td style=text-align:left>General attribute modification</td>
<td style=text-align:left><code>th:attr</code> <code>th:attrprepend</code> <code>th:attrappend</code></td>
</tr>
<tr>
<td style=text-align:left>6</td>
<td style=text-align:left>Specific attribute modification</td>
<td style=text-align:left><code>th:value</code> <code>th:href</code> <code>th:src</code> <code>...</code></td>
</tr>
<tr>
<td style=text-align:left>7</td>
<td style=text-align:left>Text (tag body modification)</td>
<td style=text-align:left><code>th:text</code> <code>th:utext</code></td>
</tr>
<tr>
<td style=text-align:left>8</td>
<td style=text-align:left>Fragment specification</td>
<td style=text-align:left><code>th:fragment</code></td>
</tr>
<tr>
<td style=text-align:left>9</td>
<td style=text-align:left>Fragment removal</td>
<td style=text-align:left><code>th:remove</code></td>
</tr>
</tbody>
</table>
<p>这个优先机制意味着如果属性位置被反转，上述迭代片段将给出完全相同的结果（尽管它的可读性稍差）：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>ul</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>li</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${item.description}&#34;</span> <span style=color:#c4a000>th:each</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;item : ${items}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Item description here...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>li</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>ul</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-75f12df78c0ac5f78030b77ad55a7c6d>10 - CH10-注释及注释块</h1>
<h2 id=标准-htmlxml-注释>标准 HTML/XML 注释</h2>
<p>标准 HTML/XML 注释<code>&lt;!-- ... --></code> 可以在模版中使用：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#8f5902;font-style:italic>&lt;!-- User info follows --&gt;</span>
<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${...}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  ...
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=thymeleaf-解析器级注释块>Thymeleaf 解析器级注释块</h2>
<p>解析器级注释块是当 Thymeleaf 解析它的模板时，这些代码将被简单地从中删除。 他们看起来像这样：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#8f5902;font-style:italic>&lt;!--/* This code will be removed at Thymeleaf parsing time! */--&gt;</span>
</code></pre></div><p>Thymeleaf将删除<code>&lt;!--/*</code> 和 <code>*/--></code>之间的所有内容，所以这些注释块也可以用于在模板静态打开时显示代码，当Thymeleaf处理它会被删除：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#8f5902;font-style:italic>&lt;!--/*--&gt;</span> 
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
     you can see me only before Thymeleaf processes me!
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#8f5902;font-style:italic>&lt;!--*/--&gt;</span>
</code></pre></div><p>这在原型中设计中有很多 <code>&lt;tr></code>时，非常适用：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span> <span style=color:#c4a000>th:each</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;x : ${xs}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
     ...
   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
   <span style=color:#8f5902;font-style:italic>&lt;!--/*--&gt;</span>
   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
     ...
   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
   <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
     ...
   <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
   <span style=color:#8f5902;font-style:italic>&lt;!--*/--&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=原型注释块>原型注释块</h2>
<p>原型注释块是指，当模版静态打开时（比如原型设计），原型注释块所注释的代码将被注释，而在模版执行时，这些注释的代码，就能被显示出来。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>hello!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#8f5902;font-style:italic>&lt;!--/*/
</span><span style=color:#8f5902;font-style:italic>  &lt;div th:text=&#34;${...}&#34;&gt;
</span><span style=color:#8f5902;font-style:italic>    ...
</span><span style=color:#8f5902;font-style:italic>  &lt;/div&gt;
</span><span style=color:#8f5902;font-style:italic>/*/--&gt;</span>
<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>goodbye!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>Thymeleaf 的解析系统将简单地删除<code>&lt;!--/*/</code> 和 <code>/*/--></code> 标记，但保留所注释的内容。 那么什么时候执行模板，Thymeleaf 实际上会看到：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>hello!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>

  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${...}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    ...
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>

<span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>goodbye!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>与解析器级注释块一样，此功能与方言无关。</p>
<h2 id=合成thblock标签>合成<code>th:block</code>标签</h2>
<p>标准方言中包含的唯一的元素处理器（不是属性）是<code>th:block</code>。</p>
<p><code>th：block</code>只是一个属性容器，允许模板开发人员指定他们想要的任何属性。 Thymeleaf 将执行这些属性，然后简单地制作块，而不是让其内容消失。</p>
<p>因此，例如，当为每个元素创建需要多个<code>&lt;tr></code> 的迭代时，这可能是有用的：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th:block</span> <span style=color:#c4a000>th:each</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;user : ${users}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.login}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>colspan</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;2&#34;</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.address}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th:block</span><span style=color:#000;font-weight:700>&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>当与原型注释块组合使用时尤其有用：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#8f5902;font-style:italic>&lt;!--/*/ &lt;th:block th:each=&#34;user : ${users}&#34;&gt; /*/--&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.login}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>td</span> <span style=color:#c4a000>colspan</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;2&#34;</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${user.address}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>...<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>td</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#8f5902;font-style:italic>&lt;!--/*/ &lt;/th:block&gt; /*/--&gt;</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-86abf045bab87e9849dc45e08f247d65>11 - CH11-内联</h1>
<h2 id=表达式内联>表达式内联</h2>
<p>虽然标准方言使我们能够使用标签属性来做几乎所有的事情，但是有些情况下我们更喜欢将表达式直接写入我们的HTML文本。 例如，我们可以喜欢写这个：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Hello, [[${session.user.name}]]!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>来代替:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Hello, <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>th:text</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${session.user.name}&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Sebastian<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p><code>[[...]]</code> 或 <code>[(...)]</code> 被称为 <strong>内联表达式（inlined expressions）</strong>，分别对应于 <code>th:text</code> 和 <code>th:utext</code> 属性。</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>The message is &#34;[(${msg})]&#34;<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>这个的结果显示， <code>&lt;b></code> 标签不会被转义:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>The message is &#34;This is <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>b</span><span style=color:#000;font-weight:700>&gt;</span>great!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>b</span><span style=color:#000;font-weight:700>&gt;</span>&#34;<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>如果是这样:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>The message is &#34;[[${msg}]]&#34;<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>则结果会被转义:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>The message is &#34;This is <span style=color:#ce5c00>&amp;lt;</span>b<span style=color:#ce5c00>&amp;gt;</span>great!<span style=color:#ce5c00>&amp;lt;</span>/b<span style=color:#ce5c00>&amp;gt;</span>&#34;<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h3 id=内联与自然模板>内联与自然模板</h3>
<p>虽然内联看上去比自然模板更加简洁，但它并不总是适用，比如当您静态打开HTML文件时，会逐字显示，因为内联无法将它们用作设计原型了！</p>
<h3 id=禁用内联>禁用内联</h3>
<p>有时，我们想禁用这种机制，比如，想输出 <code>[[...]]</code> 或 <code>[(...)]</code> 文本内容，而不是将其视为表达式。 为此，我们将使用 <code>th:inline="none"</code>：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;none&#34;</span><span style=color:#000;font-weight:700>&gt;</span>A double array looks like this: [[1, 2, 3], [4, 5]]!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>结果为：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>A double array looks like this: [[1, 2, 3], [4, 5]]!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h2 id=文本内联>文本内联</h2>
<p><em>文本内联</em>与我们拥有的<em>表达式内联</em>功能非常相似，但实际上拥有了更多的能力。 为了启用它我们使用<code>th:inline="text"</code>。</p>
<p>文本内联不仅允许我们使用相同的<em>内联表达式</em>，而且实际上可以处理在“TEXT”模板模式下的标签体。</p>
<p>我们将在下一章中看到关于[文本模板模式]的更多信息。</p>
<h2 id=javascript-内联>JavaScript 内联</h2>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;javascript&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>...</span>
    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>username</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[[</span><span style=color:#000>$</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>session</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>user</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>name</span><span style=color:#000;font-weight:700>}]];</span>
    <span style=color:#000;font-weight:700>...</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>结果为:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;javascript&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>...</span>
    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>username</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Sebastian \&#34;Fruity\&#34; Applejuice&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>...</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h3 id=javascript-自然模版>JavaScript 自然模版</h3>
<p>我们可以在JavaScript中包装（转义）内联的表达式注释如下：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;javascript&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>...</span>
    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>username</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#8f5902;font-style:italic>/*[[${session.user.name}]]*/</span> <span style=color:#4e9a06>&#34;Gertrud Kiwifruit&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>...</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>Thymeleaf 将会忽略所有注释之后分号之前的内容（就是例子中的<code>'Gertrud Kiwifruit'</code>）。所以结果输出如下:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;javascript&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>...</span>
    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>username</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Sebastian \&#34;Fruity\&#34; Applejuice&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>...</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><h3 id=高级内联评估和javascript序列化>高级内联评估和JavaScript序列化</h3>
<p>关于JavaScript内联的一个重要的事情是这个表达式评估是非常智能的，并不仅限于字符串的处理。Thymeleaf 会正确写入 JavaScript 语法中的以下几种对象：</p>
<ul>
<li>String</li>
<li>Number</li>
<li>Boolean</li>
<li>Array</li>
<li>Collection</li>
<li>Map</li>
<li>Bean (有 <em>getter</em> and <em>setter</em> 方法的对象)</li>
</ul>
<p>例如，如果我们有以下代码：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;javascript&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>...</span>
    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>user</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#8f5902;font-style:italic>/*[[${session.user}]]*/</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>...</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>那个 <code>${session.user}</code> 表达式将评估为一个<code>User</code>对象，Thymeleaf 将正确转换为 JavaScript 语法：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;javascript&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>...</span>
    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>user</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;age&#34;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;firstName&#34;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#4e9a06>&#34;John&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;lastName&#34;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#4e9a06>&#34;Apricot&#34;</span><span style=color:#000;font-weight:700>,</span>
                <span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#4e9a06>&#34;John Apricot&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;nationality&#34;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#4e9a06>&#34;Antarctica&#34;</span><span style=color:#000;font-weight:700>};</span>
    <span style=color:#000;font-weight:700>...</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>这个 JavaScript 序列化的方式是通过实现<code>org.thymeleaf.standard.serializer.IStandardJavaScriptSerializer</code> 接口来实现的，可以在 <code>StandardDialect</code>的实例配置被用于模板引擎。</p>
<p>此JS序列化机制的默认实现将会查找在类路径中[Jackson 库]，如果存在，将会使用它。如果没有，它将应用一个内置的序列化机制。这涵盖了大多数场景的需求，并产生了类似的结果（但是 相比较 Jackson 而言不够灵活）。</p>
<h2 id=css-内联>CSS 内联</h2>
<p>Thymeleaf 允许使用 CSS <code>&lt;style></code>标签，比如:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>style</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;css&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
  <span style=color:#ce5c00;font-weight:700>...</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>style</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>比如，我们想设置两个变量到不同的<code>String</code>值:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>classname = &#39;main elems&#39;
align = &#39;center&#39;
</code></pre></div><p>我们可以这么做:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>style</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;css&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#ce5c00;font-weight:700>.[[$</span><span style=color:#000;font-weight:700>{</span><span style=color:#a40000>classname</span><span style=color:#000;font-weight:700>}</span><span style=color:#ce5c00;font-weight:700>]]</span> <span style=color:#000;font-weight:700>{</span>
      <span style=color:#204a87;font-weight:700>text-align</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[[</span><span style=color:#a40000>${</span><span style=color:#000>align</span><span style=color:#000;font-weight:700>}</span><span style=color:#ce5c00;font-weight:700>]];</span>
    <span style=color:#a40000>}</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>style</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>结果为:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>style</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;css&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>main</span><span style=color:#a40000>\</span> <span style=color:#204a87;font-weight:700>elems</span> <span style=color:#000;font-weight:700>{</span>
      <span style=color:#204a87;font-weight:700>text-align</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>center</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>style</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div><p>请注意，CSS 内联中还包含一些<em>智能</em>处理，就像JavaScript 内联一样。具体来说，通过<em>转义</em>表达式来输出表达式，如 <code>[[${classname}]]</code> 将被转义为<strong>CSS 标识符</strong>。 这就是为什么我们的 <code>classname = 'main elems'</code>在上面的代码片段中变成了<code>main\ elems</code>。</p>
<h3 id=css-自然模版>CSS 自然模版</h3>
<p>与JavaScript 类似，也有 CSS 自然模版，用法如下：</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>style</span> <span style=color:#c4a000>th:inline</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;css&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>main</span><span style=color:#a40000>\</span> <span style=color:#204a87;font-weight:700>elems</span> <span style=color:#000;font-weight:700>{</span>
      <span style=color:#204a87;font-weight:700>text-align</span><span style=color:#000;font-weight:700>:</span> <span style=color:#8f5902;font-style:italic>/*[[${align}]]*/</span> <span style=color:#204a87;font-weight:700>left</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>style</span><span style=color:#000;font-weight:700>&gt;</span>
</code></pre></div>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Weibo aria-label=Weibo>
<a class=text-white target=_blank rel="noopener noreferrer" href=https://weibo.com/u/3848950217>
<i class="fab fa-weibo"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter>
<a class=text-white target=_blank rel="noopener noreferrer" href=https://twitter.com/zhange_zzg>
<i class="fab fa-twitter"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow">
<a class=text-white target=_blank rel="noopener noreferrer" href=https://stackoverflow.com>
<i class="fab fa-stack-overflow"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/infilos/infilos.com>
<i class="fab fa-github"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2021 infilos.com All Rights Reserved</small>
</div>
</div>
</div>
</footer>
</div>
<script src=/js/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script>
<script src=/js/main.min.5c74b870c6953931a705f390a49c7e4c0a842ec5c83b24354758dd674343ed0d.js integrity="sha256-XHS4cMaVOTGnBfOQpJx+TAqELsXIOyQ1R1jdZ0ND7Q0=" crossorigin=anonymous></script>
</body>
</html>